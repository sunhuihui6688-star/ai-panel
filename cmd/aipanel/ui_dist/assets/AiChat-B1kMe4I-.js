import{d as je,e as m,D as Fe,i as Oe,c as a,f as x,n as Be,s as E,a as b,w as F,T as Le,b as o,k as d,t as h,F as $,m as S,h as G,p as Je,G as Re,g as re,z as Ee,H as P,r as J,o as l,j as ce}from"./index-BH3wezV0.js";import{n as Pe,k as Ue}from"./index-BpGprwnc.js";import{_ as He}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ze={key:0,class:"history-loading"},qe={key:1,class:"chat-empty"},Ke={key:0,class:"welcome-msg"},Ve={key:1,class:"examples"},We=["onClick"],Ge={key:0,class:"msg-row user"},Xe={class:"msg-bubble user"},Ye={key:0,class:"msg-images"},Qe=["src","onClick"],Ze={class:"msg-text"},et={key:1,class:"msg-row assistant"},tt={class:"msg-col"},st=["open"],nt={class:"thinking-summary"},ot={class:"thinking-len"},lt={class:"thinking-content"},at={key:1,class:"tool-timeline"},it=["onClick"],rt={class:"tool-step-header"},ct={key:0,class:"tool-spin"},ut={key:1},dt={key:2},pt={key:3},ht={class:"tool-step-icon"},ft={class:"tool-step-name"},vt={key:0,class:"tool-step-summary"},gt={key:1,class:"tool-step-dur"},_t={class:"tool-step-chevron"},mt={key:0,class:"tool-section"},yt={class:"tool-pre"},kt={key:1,class:"tool-section"},xt={class:"tool-pre result"},bt={class:"msg-bubble assistant"},wt=["innerHTML"],Ct={key:1,class:"apply-card"},$t={class:"apply-preview"},Tt={class:"apply-key"},St={class:"apply-val"},It=["onClick"],Dt={class:"msg-actions"},Mt=["onClick","title"],At=["onClick"],Nt=["onClick"],jt={key:2,class:"option-chips"},Ft=["onClick"],Ot={key:2,class:"msg-row system"},Bt={class:"msg-system"},Lt={key:2,class:"msg-row assistant"},Jt={class:"msg-col"},Rt={key:0,class:"thinking-block",open:""},Et={class:"thinking-summary"},Pt={class:"thinking-content"},Ut={key:1,class:"tool-timeline"},Ht=["onClick"],zt={class:"tool-step-header"},qt={key:0,class:"tool-spin"},Kt={key:1},Vt={key:2},Wt={class:"tool-step-icon"},Gt={class:"tool-step-name"},Xt={key:0,class:"tool-step-summary"},Yt={key:1,class:"tool-step-dur"},Qt={class:"tool-step-chevron"},Zt={key:0,class:"tool-section"},es={class:"tool-pre"},ts={key:1,class:"tool-section"},ss={class:"tool-pre result"},ns={key:2,class:"msg-bubble assistant"},os={key:0,class:"typing-dots"},ls=["innerHTML"],as={key:2,class:"blink"},is=["src"],rs={class:"chat-input-area"},cs={key:0,class:"attachments-bar"},us=["src"],ds=["onClick"],ps={class:"attach-file-icon"},hs={class:"attach-file-name"},fs={class:"attach-file-size"},vs=["onClick"],gs={class:"input-row"},_s={class:"textarea-wrap"},ms=["placeholder","disabled","onKeydown"],ys={class:"input-actions"},ks={class:"icon-btn",title:"é™„åŠ æ–‡ä»¶ï¼ˆå›¾ç‰‡/ä»£ç /æ–‡æœ¬ï¼‰"},xs=["disabled"],bs={key:0,class:"spinner"},ws={key:1},Cs=je({__name:"AiChat",props:{agentId:{},sessionId:{},context:{},scenario:{},skillId:{},placeholder:{},welcomeMessage:{},examples:{default:()=>[]},showThinking:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},bgColor:{},height:{},initialMessages:{},applyable:{type:Boolean,default:!1}},emits:["message","response","apply","session-change","streaming-change"],setup(w,{expose:ue,emit:de}){const y=w,R=de,g=m(y.initialMessages?[...y.initialMessages]:[]),O=m(""),M=m([]),A=m([]),T=m(!1);Fe(T,t=>R("streaming-change",t));const k=m(""),B=m(""),I=m([]),N=m(!1),U=m(null),H=m(""),j=m(y.sessionId),L=m(!1),z=m(),D=m(),pe=Ee(()=>({height:y.height??"100%","--bg":y.bgColor??"transparent"}));function C(){P(()=>{z.value&&(z.value.scrollTop=z.value.scrollHeight)})}function he(){D.value&&(D.value.style.height="auto",D.value.style.height=Math.min(D.value.scrollHeight,160)+"px")}function q(t){O.value=t,P(()=>D.value?.focus())}function Q(t){try{return JSON.stringify(JSON.parse(t),null,2)}catch{return t}}function fe(t){navigator.clipboard?.writeText(t);const e=g.value.findIndex(n=>n.text===t);U.value=e,setTimeout(()=>{U.value=null},1500)}function ve(t){for(let e=t-1;e>=0;e--){const n=g.value[e];if(n&&n.role==="user"){const c=n.text,f=n.images??[];g.value.splice(e,g.value.length-e),Y(c,f);return}}}function ge(t){H.value=t}function Z(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/```(\w*)\n([\s\S]*?)```/g,(n,c,f)=>`<pre class="code-block${c?" lang-"+c:""}"><code>${f}</code></pre>`).replace(/`([^`]+)`/g,'<code class="inline-code">$1</code>').replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/\[(.+?)\]\((https?:\/\/[^\)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>').replace(/^### (.+)$/gm,"<h3>$1</h3>").replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/^[-*] (.+)$/gm,"<li>$1</li>").replace(/^\d+\. (.+)$/gm,"<li>$1</li>").replace(/(<li>[\s\S]+?<\/li>)(\n(?!<li>)|$)/g,"<ul>$1</ul>$2").replace(/([^>])\n([^<])/g,"$1<br>$2"):""}function _e(t){const e=t.split(`
`),n=[],c=/^([ğŸ™ğŸ˜„ğŸŒğŸ›ğŸ“šğŸ¨ğŸ’¼ğŸ¤–âš½ğŸ¯âœ…âŒğŸ”¥ğŸ’¡ğŸğŸš€ğŸŒŸğŸ’ğŸªğŸ­ğŸ¬ğŸ¤]|[\u{1F300}-\u{1FFFF}]|[\u{2600}-\u{27BF}])\s+(.{4,40})/u;for(const f of e){const u=f.replace(/^[-*â€¢]\s*/,"").trim();if(u.match(c)){const _=u.replace(/[ï¼š:ã€‚ï¼Œ,]$/,"").trim();_.length>=5&&n.push(_)}}return n.slice(0,5)}function me(t){return t?/\{[\s\S]{30,}\}/.test(t)&&(t.includes('"name"')||t.includes('"identity"')||t.includes('"soul"')||t.includes('"IDENTITY"')||t.includes('"SOUL"')):!1}function ye(t){const e=te(t.text);console.log("[AiChat] manualApply result:",e),e?(t.applyData=e,P(()=>R("apply",e))):alert("æœªèƒ½ä»æ¶ˆæ¯ä¸­æå–åˆ°é…ç½® JSONï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶")}function ee(t,e=0){const n=t.indexOf("{",e);if(n===-1)return null;let c=0,f=!1,u=!1;for(let p=n;p<t.length;p++){const _=t[p];if(u){u=!1;continue}if(_==="\\"&&f){u=!0;continue}if(_==='"'){f=!f;continue}if(!f){if(_==="{")c++;else if(_==="}"&&(c--,c===0))return{raw:t.slice(n,p+1),end:p+1}}}return null}function te(t){const e=/```(?:json)?\s*\n?([\s\S]*?)```/g,n=[];let c;for(;(c=e.exec(t))!==null;){const p=(c[1]??"").trim();p.startsWith("{")&&n.push(p)}for(let p=n.length-1;p>=0;p--){const _=n[p],s=ee(_);if(!s)continue;const r=K(s.raw)??K(se(s.raw));if(r)return r}const f=[];let u=0;for(;u<t.length;){const p=ee(t,u);if(!p)break;f.push(p.raw),u=p.end}for(let p=f.length-1;p>=0;p--){const _=f[p],s=K(_)??K(se(_));if(s)return s}return null}function K(t){try{const e=JSON.parse(t);if(e&&typeof e=="object"&&!Array.isArray(e)){const n=["name","id","description","identity","soul","IDENTITY","SOUL","NAME","DESCRIPTION"];if(Object.keys(e).some(c=>n.includes(c)))return e}}catch{}return null}function se(t){let e="",n=!1,c=!1;for(let f=0;f<t.length;f++){const u=t[f];if(c){e+=u,c=!1;continue}if(u==="\\"&&n){e+=u,c=!0;continue}if(u==='"'){n=!n,e+=u;continue}if(n&&u===`
`){e+="\\n";continue}if(n&&u==="\r"){e+="\\r";continue}e+=u}return e}const ke={exec:"âš¡",bash:"âš¡",read:"ğŸ“–",write:"âœï¸",edit:"âœï¸",web_search:"ğŸŒ",web_fetch:"ğŸŒ",browser:"ğŸŒ",agent_spawn:"ğŸš€",agent_tasks:"ğŸ“‹",agent_kill:"ğŸ›‘",agent_result:"ğŸ“Š",project_read:"ğŸ“",project_write:"ğŸ“",project_list:"ğŸ“",project_create:"ğŸ“",project_glob:"ğŸ“",memory_search:"ğŸ§ ",memory_get:"ğŸ§ ",image:"ğŸ–¼ï¸",tts:"ğŸ”Š",cron:"â±ï¸"};function ne(t){return ke[t]??"âš™ï¸"}function oe(t,e){try{const n=JSON.parse(e);if(t==="exec"||t==="bash")return(n.command??"").slice(0,60);if(t==="read")return n.file_path??n.path??"";if(t==="write")return(n.file_path??n.path??"")+(n.content?` (${n.content.length}B)`:"");if(t==="edit")return n.file_path??n.path??"";if(t==="web_search")return n.query??"";if(t==="web_fetch")return n.url??"";if(t==="agent_spawn")return`â†’ ${n.agentId}: ${(n.task??"").slice(0,40)}`;if(t==="project_read"||t==="project_write")return n.path??"";if(t==="memory_search")return n.query??""}catch{}return""}const xe=new Set(["txt","md","markdown","js","ts","jsx","tsx","vue","go","py","rs","java","kt","swift","html","css","scss","less","json","yaml","yml","toml","ini","cfg","env","sh","bash","zsh","fish","ps1","bat","cmd","dockerfile","makefile","sql","graphql","proto","xml","svg","gitignore","gitattributes"]);function le(t){const e=t.split(".").pop()?.toLowerCase()??"";return xe.has(e)}function be(t){const e=t.split(".").pop()?.toLowerCase()??"";return{js:"ğŸŸ¨",ts:"ğŸ”µ",vue:"ğŸ’š",go:"ğŸ¹",py:"ğŸ",rs:"ğŸ¦€",html:"ğŸŒ",css:"ğŸ¨",json:"ğŸ“‹",md:"ğŸ“",sh:"âš¡",sql:"ğŸ—„ï¸",yaml:"âš™ï¸",yml:"âš™ï¸",dockerfile:"ğŸ³"}[e]??"ğŸ“„"}function we(t){return t<1024?`${t}B`:t<1024*1024?`${(t/1024).toFixed(1)}KB`:`${(t/1024/1024).toFixed(1)}MB`}function Ce(t){const e=t.clipboardData?.items;if(e){for(const n of Array.from(e))if(n.type.startsWith("image/")){t.preventDefault();const c=n.getAsFile();c&&X(c)}}}function ae(t){N.value=!1;const e=t.dataTransfer?.files;if(e)for(const n of Array.from(e))n.type.startsWith("image/")?X(n):le(n.name)&&ie(n)}function $e(t){const e=t.target.files;if(e){for(const n of Array.from(e))n.type.startsWith("image/")?X(n):le(n.name)&&ie(n);t.target.value=""}}function ie(t){const e=new FileReader;e.onload=()=>{typeof e.result=="string"&&A.value.push({name:t.name,content:e.result})},e.readAsText(t)}function X(t){const e=new FileReader;e.onload=()=>{typeof e.result=="string"&&M.value.push(e.result)},e.readAsDataURL(t)}function Te(t){M.value.splice(t,1)}function V(){const t=O.value.trim(),e=[...M.value],n=[...A.value];if(!t&&!e.length&&!n.length||T.value)return;let c=t;if(n.length>0){const f=n.map(u=>{const p=u.name.split(".").pop()??"text";return`

ğŸ“ **${u.name}**
\`\`\`${p}
${u.content}
\`\`\``}).join("");c=t?t+f:f.trimStart()}O.value="",M.value=[],A.value=[],P(()=>{D.value&&(D.value.style.height="auto")}),R("message",c,e),Y(c,e)}function Y(t,e,n=!1){n||(g.value.push({role:"user",text:t,images:e.length?e:void 0}),C()),T.value=!0,k.value="",B.value="",I.value=[];const c={role:"assistant",text:"",toolCalls:[]};g.value.push(c),n&&C();const f=g.value.length-1;let u="",p;if(j.value)p=void 0;else{const s=g.value.slice(0,-1).filter(r=>(r.role==="user"||r.role==="assistant")&&r.text).slice(-20).map(r=>({role:r.role,content:r.text}));p=s.length>0?s:void 0}const _={sessionId:j.value,context:y.context,scenario:y.scenario,skillId:y.skillId,images:e.length?e:void 0,history:p};Pe(y.agentId,t,s=>{switch(s.type){case"thinking_delta":B.value+=s.text,C();break;case"text":case"text_delta":k.value+=s.text,C();break;case"tool_call":{const r={id:s.tool_call?.id??String(Date.now()),name:s.tool_call?.name??"tool",input:s.tool_call?.input?JSON.stringify(s.tool_call.input):void 0,status:"running",_startedAt:Date.now(),_expanded:!1};g.value[f].toolCalls.push(r),I.value.push(r),u=r.id,C();break}case"tool_result":{const r=g.value[f].toolCalls?.find(i=>i.id===u);if(r){if(r.result=s.text,r.status="done",r._startedAt){const v=Date.now()-r._startedAt;r.duration=v<1e3?`${v}ms`:`${(v/1e3).toFixed(1)}s`}const i=I.value.find(v=>v.id===u);i&&(i.result=r.result,i.status="done",i.duration=r.duration)}C();break}case"done":case"error":{if(s.type==="done"&&s.sessionId){const v=!j.value;j.value=s.sessionId,v&&R("session-change",s.sessionId)}const r=g.value[f];if(r.text=k.value,r.thinking=B.value||void 0,y.applyable){const v=te(k.value);v?(r.applyData=v,console.log("[AiChat] applyData extracted:",v)):console.log("[AiChat] no applyData found in text length:",k.value.length)}const i=_e(k.value);if(i.length>=2&&(r.options=i),s.type==="error"){r.text=`[é”™è¯¯] ${s.error}`;const v=r.toolCalls?.find(W=>W.status==="running");v&&(v.status="error")}T.value=!1,k.value="",B.value="",I.value=[],R("response",r.text),C();break}}},_)}function Se(){g.value=[]}function Ie(t){g.value.push(t),C()}async function De(t){j.value=t,g.value=[],L.value=!0;try{const n=(await Ue.get(y.agentId,t)).data.messages??[],c=[];n.some(u=>u.isCompact||u.role==="compaction")&&c.push({role:"system",text:"æ›´æ—©çš„å†…å®¹å·²å‹ç¼©"});for(const u of n)u.role!=="compaction"&&c.push({role:u.role,text:u.text});g.value=c,C()}catch(e){e?.response?.status===404?g.value=[]:(console.error("[AiChat] resumeSession failed",e),g.value=[{role:"system",text:"å†å²åŠ è½½å¤±è´¥ï¼Œç»§ç»­å¯¹è¯ä»å¯æ¥ç»­"}])}finally{L.value=!1}}function Me(){j.value=void 0,g.value=[]}function Ae(t){q(t),P(V)}function Ne(t){Y(t,[],!0)}return ue({clearMessages:Se,appendMessage:Ie,sendText:Ae,sendSilent:Ne,fillInput:q,messages:g,streaming:T,currentSessionId:j,resumeSession:De,startNewSession:Me}),Oe(()=>{C()}),(t,e)=>{const n=J("ChatRound"),c=J("el-icon"),f=J("Check"),u=J("CopyDocument"),p=J("Setting"),_=J("Paperclip");return l(),a("div",{class:E(["ai-chat",{compact:w.compact,"has-bg":w.bgColor,"drag-active":N.value}]),style:Be(pe.value),onDragenter:e[6]||(e[6]=x(s=>N.value=!0,["prevent"])),onDragover:e[7]||(e[7]=x(s=>N.value=!0,["prevent"])),onDragleave:e[8]||(e[8]=x(s=>N.value=!1,["self"])),onDrop:x(ae,["prevent"])},[b(Le,{name:"drag-fade"},{default:F(()=>[N.value?(l(),a("div",{key:0,class:"drag-overlay",onDragover:e[0]||(e[0]=x(()=>{},["prevent"])),onDragleave:e[1]||(e[1]=x(s=>N.value=!1,["prevent"])),onDrop:x(ae,["prevent"])},[...e[9]||(e[9]=[o("div",{class:"drag-overlay-content"},[o("div",{class:"drag-overlay-icon"},"ğŸ“"),o("div",{class:"drag-overlay-title"},"é‡Šæ”¾ä»¥é™„åŠ æ–‡ä»¶"),o("div",{class:"drag-overlay-hint"},"æ”¯æŒå›¾ç‰‡ Â· ä»£ç  Â· æ–‡æœ¬æ–‡ä»¶")],-1)])],32)):d("",!0)]),_:1}),o("div",{class:"chat-messages",ref_key:"msgListRef",ref:z},[L.value?(l(),a("div",ze,[...e[10]||(e[10]=[o("div",{class:"history-loading-dots"},[o("span"),o("span"),o("span")],-1),o("div",{class:"history-loading-text"},"åŠ è½½å†å²å¯¹è¯â€¦",-1)])])):d("",!0),!g.value.length&&!L.value?(l(),a("div",qe,[w.welcomeMessage?(l(),a("div",Ke,h(w.welcomeMessage),1)):d("",!0),w.examples.length?(l(),a("div",Ve,[(l(!0),a($,null,S(w.examples,(s,r)=>(l(),a("div",{key:r,class:"example-chip",onClick:i=>q(s)},h(s),9,We))),128))])):d("",!0)])):d("",!0),(l(!0),a($,null,S(g.value,(s,r)=>(l(),a($,{key:r},[s.role==="user"?(l(),a("div",Ge,[o("div",Xe,[s.images?.length?(l(),a("div",Ye,[(l(!0),a($,null,S(s.images,(i,v)=>(l(),a("img",{key:v,src:i,class:"msg-img",onClick:W=>ge(i)},null,8,Qe))),128))])):d("",!0),o("div",Ze,h(s.text),1)])])):s.role==="assistant"?(l(),a("div",et,[o("div",tt,[s.thinking?(l(),a("details",{key:0,class:"thinking-block",open:w.showThinking},[o("summary",nt,[b(c,{class:"thinking-icon"},{default:F(()=>[b(n)]),_:1}),e[11]||(e[11]=G(" æ€è€ƒè¿‡ç¨‹ ",-1)),o("span",ot,h(s.thinking.length)+" å­—ç¬¦",1)]),o("pre",lt,h(s.thinking),1)],8,st)):d("",!0),s.toolCalls?.length?(l(),a("div",at,[(l(!0),a($,null,S(s.toolCalls,(i,v)=>(l(),a("div",{key:v,class:E(["tool-step",i.status]),onClick:W=>i._expanded=!i._expanded},[o("div",rt,[o("span",{class:E(["tool-step-dot",i.status])},[i.status==="running"?(l(),a("span",ct,"âŸ³")):i.status==="done"?(l(),a("span",ut,"âœ“")):i.status==="error"?(l(),a("span",dt,"âœ—")):(l(),a("span",pt,"â—‹"))],2),o("span",ht,h(ne(i.name)),1),o("code",ft,h(i.name),1),i.input?(l(),a("span",vt,h(oe(i.name,i.input)),1)):d("",!0),e[12]||(e[12]=o("span",{class:"tool-step-flex"},null,-1)),i.duration?(l(),a("span",gt,h(i.duration),1)):d("",!0),o("span",_t,h(i._expanded?"â–²":"â–¼"),1)]),i._expanded?(l(),a("div",{key:0,class:"tool-step-body",onClick:e[2]||(e[2]=x(()=>{},["stop"]))},[i.input?(l(),a("div",mt,[e[13]||(e[13]=o("div",{class:"tool-label"},"INPUT",-1)),o("pre",yt,h(Q(i.input)),1)])):d("",!0),i.result?(l(),a("div",kt,[e[14]||(e[14]=o("div",{class:"tool-label"},"OUTPUT",-1)),o("pre",xt,h(i.result.slice(0,3e3))+h(i.result.length>3e3?`
â€¦ (æˆªæ–­)`:""),1)])):d("",!0)])):d("",!0)],10,it))),128))])):d("",!0),o("div",bt,[s.text?(l(),a("div",{key:0,class:"msg-text",innerHTML:Z(s.text)},null,8,wt)):d("",!0),s.applyData&&y.applyable?(l(),a("div",Ct,[o("div",$t,[(l(!0),a($,null,S(s.applyData,(i,v)=>(l(),a("div",{key:v,class:"apply-row"},[o("span",Tt,h(v),1),o("span",St,h(String(i).slice(0,60))+h(String(i).length>60?"â€¦":""),1)]))),128))]),o("button",{class:"apply-btn",onClick:i=>t.$emit("apply",s.applyData)}," åº”ç”¨åˆ°è¡¨å• â†™ ",8,It)])):d("",!0),o("div",Dt,[o("button",{class:"act-btn",onClick:i=>fe(s.text),title:U.value===r?"å·²å¤åˆ¶":"å¤åˆ¶"},[U.value===r?(l(),ce(c,{key:0},{default:F(()=>[b(f)]),_:1})):(l(),ce(c,{key:1},{default:F(()=>[b(u)]),_:1}))],8,Mt),o("button",{class:"act-btn",onClick:i=>ve(r),title:"é‡è¯•"},"â†º",8,At),y.applyable&&!s.applyData&&me(s.text)?(l(),a("button",{key:0,class:"act-btn apply-manual-btn",onClick:i=>ye(s),title:"æ£€æµ‹åˆ°é…ç½® JSONï¼Œç‚¹å‡»åº”ç”¨"},[b(c,null,{default:F(()=>[b(p)]),_:1}),e[15]||(e[15]=G(" åº”ç”¨é…ç½® ",-1))],8,Nt)):d("",!0)])]),s.options&&s.options.length?(l(),a("div",jt,[(l(!0),a($,null,S(s.options,(i,v)=>(l(),a("button",{key:v,class:"option-chip",onClick:W=>q(i)},h(i),9,Ft))),128))])):d("",!0)])])):s.role==="system"?(l(),a("div",Ot,[o("div",Bt,h(s.text),1)])):d("",!0)],64))),128)),T.value?(l(),a("div",Lt,[o("div",Jt,[B.value&&w.showThinking?(l(),a("details",Rt,[o("summary",Et,[b(c,{class:"thinking-icon"},{default:F(()=>[b(n)]),_:1}),e[16]||(e[16]=G(" æ€è€ƒä¸­â€¦ ",-1))]),o("pre",Pt,[G(h(B.value),1),e[17]||(e[17]=o("span",{class:"blink"},"â–Š",-1))])])):d("",!0),I.value.length?(l(),a("div",Ut,[(l(!0),a($,null,S(I.value,(s,r)=>(l(),a("div",{key:r,class:E(["tool-step",s.status]),onClick:i=>s._expanded=!s._expanded},[o("div",zt,[o("span",{class:E(["tool-step-dot",s.status])},[s.status==="running"?(l(),a("span",qt,"âŸ³")):s.status==="done"?(l(),a("span",Kt,"âœ“")):s.status==="error"?(l(),a("span",Vt,"âœ—")):d("",!0)],2),o("span",Wt,h(ne(s.name)),1),o("code",Gt,h(s.name),1),s.input?(l(),a("span",Xt,h(oe(s.name,s.input)),1)):d("",!0),e[18]||(e[18]=o("span",{class:"tool-step-flex"},null,-1)),s.duration?(l(),a("span",Yt,h(s.duration),1)):d("",!0),o("span",Qt,h(s._expanded?"â–²":"â–¼"),1)]),s._expanded?(l(),a("div",{key:0,class:"tool-step-body",onClick:e[3]||(e[3]=x(()=>{},["stop"]))},[s.input?(l(),a("div",Zt,[e[19]||(e[19]=o("div",{class:"tool-label"},"INPUT",-1)),o("pre",es,h(Q(s.input)),1)])):d("",!0),s.result?(l(),a("div",ts,[e[20]||(e[20]=o("div",{class:"tool-label"},"OUTPUT",-1)),o("pre",ss,h(s.result.slice(0,3e3)),1)])):d("",!0)])):d("",!0)],10,Ht))),128))])):d("",!0),k.value||!I.value.length?(l(),a("div",ns,[!k.value&&!I.value.length?(l(),a("div",os,[...e[21]||(e[21]=[o("span",null,null,-1),o("span",null,null,-1),o("span",null,null,-1)])])):d("",!0),k.value?(l(),a("div",{key:1,class:"msg-text",innerHTML:Z(k.value)},null,8,ls)):d("",!0),k.value?(l(),a("span",as,"â–Š")):d("",!0)])):d("",!0)])])):d("",!0)],512),H.value?(l(),a("div",{key:0,class:"img-preview-mask",onClick:e[4]||(e[4]=s=>H.value="")},[o("img",{src:H.value,class:"img-preview-full"},null,8,is)])):d("",!0),o("div",rs,[M.value.length||A.value.length?(l(),a("div",cs,[(l(!0),a($,null,S(M.value,(s,r)=>(l(),a("div",{key:"img-"+r,class:"attach-thumb"},[o("img",{src:s},null,8,us),o("button",{class:"remove-attach",onClick:i=>Te(r)},"Ã—",8,ds)]))),128)),(l(!0),a($,null,S(A.value,(s,r)=>(l(),a("div",{key:"file-"+r,class:"attach-file-chip"},[o("span",ps,h(be(s.name)),1),o("span",hs,h(s.name),1),o("span",fs,h(we(s.content.length)),1),o("button",{class:"attach-file-remove",onClick:i=>A.value.splice(r,1)},"Ã—",8,vs)]))),128))])):d("",!0),o("div",gs,[o("div",_s,[Je(o("textarea",{ref_key:"inputRef",ref:D,"onUpdate:modelValue":e[5]||(e[5]=s=>O.value=s),placeholder:w.placeholder||"è¾“å…¥æ¶ˆæ¯â€¦ æ”¯æŒæ‹–æ‹½å›¾ç‰‡æˆ–æ–‡ä»¶ (Ctrl+Enter å‘é€)",disabled:T.value||L.value,rows:"1",class:"chat-textarea",onKeydown:[re(x(V,["ctrl","prevent"]),["enter"]),re(x(V,["meta","prevent"]),["enter"])],onPaste:Ce,onInput:he},null,40,ms),[[Re,O.value]])]),o("div",ys,[o("label",ks,[b(c,null,{default:F(()=>[b(_)]),_:1}),o("input",{type:"file",multiple:"",hidden:"",onChange:$e},null,32)]),o("button",{class:"send-btn",disabled:T.value||L.value||!O.value.trim()&&!M.value.length&&!A.value.length,onClick:V},[T.value?(l(),a("span",bs)):(l(),a("span",ws,"â†‘"))],8,xs)])]),e[22]||(e[22]=o("div",{class:"input-hint"},"Ctrl+Enter å‘é€ Â· æ”¯æŒæ‹–æ‹½å›¾ç‰‡/æ–‡ä»¶",-1))])],38)}}}),Is=He(Cs,[["__scopeId","data-v-a90d56f1"]]);export{Is as A};
