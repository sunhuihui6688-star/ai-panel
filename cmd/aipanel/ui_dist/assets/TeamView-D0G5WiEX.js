import{d as Q,h as Z,c as p,f as e,a as g,w as y,m as tt,i as S,j as A,g as E,E as et,r as _,J as st,o as r,e as k,F as z,l as T,t as h,n as ot,x as B,u as nt}from"./index-Zphxv18c.js";import{r as lt}from"./index-CTYBXBE4.js";import{_ as at}from"./_plugin-vue_export-helper-DlAUqK2U.js";const it={class:"team-view"},rt={class:"page-header"},ct={key:0,class:"empty-state"},dt={key:1,class:"empty-state"},ut=["height"],ft=["x1","y1","x2","y2","stroke-width","onMouseenter"],pt=["transform","onClick"],mt=["fill"],vt={"text-anchor":"middle","dominant-baseline":"central",fill:"#fff","font-weight":"700","font-size":"15","font-family":"system-ui, sans-serif"},gt=["fill"],ht={"text-anchor":"middle",y:"46","font-size":"12",fill:"#303133","font-family":"system-ui, sans-serif","paint-order":"stroke",stroke:"#f5f7fa","stroke-width":"3"},yt={"text-anchor":"middle",y:"58","font-size":"10",fill:"#909399","font-family":"system-ui, monospace"},_t={class:"tooltip-members"},xt={class:"tooltip-name"},kt={class:"tooltip-name"},bt={class:"tooltip-tags"},wt={key:0,class:"tooltip-label"},Ct={class:"legend"},Et={width:"28",height:"8"},Mt=["stroke-width"],M=820,At=28,$=150,L=80,P=80,zt=Q({__name:"TeamView",setup(Tt){const j=nt(),N=E(),b=E(!1),m=E({nodes:[],edges:[]}),R={Ê†∏ÂøÉ:4,Â∏∏Áî®:2.5,ÂÅ∂Â∞î:1.5};function I(s,t){const n={};s.forEach(a=>{n[a.id]=0});const d=s.length+2;for(let a=0;a<d;a++){let u=!1;for(const i of t){const x=n[i.from]??0,o=n[i.to]??0;if(i.type==="‰∏äÁ∫ß"){const f=x-1;o>f&&(n[i.to]=f,u=!0)}else if(i.type==="‰∏ãÁ∫ß"){const f=x+1;o<f&&(n[i.to]=f,u=!0)}}if(!u)break}const c=Object.values(n),l=c.length?Math.min(...c):0;return s.forEach(a=>{n[a.id]=(n[a.id]??0)-l}),n}const D=B(()=>I(m.value.nodes,m.value.edges)),W=B(()=>{const s=Object.values(D.value).reduce((t,n)=>Math.max(t,n),0);return Math.max(400,L+s*$+140)}),H=B(()=>{const s=m.value.nodes,t=D.value,n={};s.forEach(c=>{const l=t[c.id]??0;n[l]||(n[l]=[]),n[l].push(c.id)});const d={};for(const[c,l]of Object.entries(n)){const a=Number(c),u=L+a*$,i=M-P*2,x=l.length>1?i/(l.length-1):0;l.forEach((o,f)=>{const K=l.length===1?M/2:P+f*x;d[o]={x:Math.round(K),y:Math.round(u)}})}return d});function w(s){return H.value[s]??{x:M/2,y:L}}function C(s,t,n){const d=w(s),c=w(t),l=c.x-d.x,a=c.y-d.y,u=Math.sqrt(l*l+a*a)||1,i=At+3;return n==="start"?{x:d.x+l/u*i,y:d.y+a/u*i}:{x:c.x-l/u*i,y:c.y-a/u*i}}function X(s){return R[s]??1.5}const F=["#409EFF","#67C23A","#E6A23C","#F56C6C","#7C3AED","#0891B2","#B45309","#64748B"];function q(s){let t=0;for(let n=0;n<s.length;n++)t=s.charCodeAt(n)+((t<<5)-t);return F[Math.abs(t)%F.length]??"#409EFF"}function G(s){return(s||"?").charAt(0).toUpperCase()}function V(s){return m.value.nodes.find(t=>t.id===s)?.name??s}function J(s){j.push(`/agents/${s}`)}const v=E({visible:!1,x:0,y:0,type:"",strength:"",label:"",from:"",to:""});function U(s,t){const n=N.value?.getBoundingClientRect();n&&(v.value={visible:!0,x:s.clientX-n.left+14,y:s.clientY-n.top-10,type:t.type,strength:t.strength,label:t.label,from:t.from,to:t.to})}function Y(){v.value.visible=!1}async function O(){b.value=!0;try{const s=await lt.graph();m.value=s.data}catch{et.error("Âä†ËΩΩÂõæË∞±Â§±Ë¥•")}finally{b.value=!1}}return Z(O),(s,t)=>{const n=_("Refresh"),d=_("el-icon"),c=_("el-button"),l=_("Share"),a=_("Connection"),u=_("el-tag"),i=_("el-card"),x=st("loading");return r(),p("div",it,[e("div",rt,[t[1]||(t[1]=e("h2",null,"Âõ¢ÈòüÂÖ≥Á≥ªÂõæË∞±",-1)),g(c,{size:"small",onClick:O},{default:y(()=>[g(d,null,{default:y(()=>[g(n)]),_:1}),t[0]||(t[0]=k(" Âà∑Êñ∞ ",-1))]),_:1})]),tt((r(),S(i,{class:"graph-card"},{default:y(()=>[!b.value&&!m.value.nodes.length?(r(),p("div",ct,[g(d,{style:{"font-size":"64px",color:"#c0c4cc",display:"block",margin:"0 auto 16px"}},{default:y(()=>[g(l)]),_:1}),t[2]||(t[2]=e("p",{style:{color:"#909399","text-align":"center",margin:"0"}},"ÊöÇÊó†ÊàêÂëòÊï∞ÊçÆ",-1))])):!b.value&&m.value.nodes.length&&!m.value.edges.length?(r(),p("div",dt,[g(d,{style:{"font-size":"64px",color:"#c0c4cc",display:"block",margin:"0 auto 16px"}},{default:y(()=>[g(a)]),_:1}),t[3]||(t[3]=e("p",{style:{color:"#909399","text-align":"center",margin:"0"}},"‰∏∫ÊàêÂëòÈÖçÁΩÆ RELATIONS.md Âç≥ÂèØËá™Âä®ÁîüÊàêÂÖ≥Á≥ªÂõæË∞±",-1)),t[4]||(t[4]=e("p",{style:{color:"#c0c4cc","text-align":"center","font-size":"13px",margin:"6px 0 0"}}," ÂâçÂæÄÊàêÂëòËØ¶ÊÉÖÈ°µ ‚Üí „ÄåÂÖ≥Á≥ª„ÄçTab ÁºñËæë ",-1))])):(r(),p("div",{key:2,class:"graph-container",ref_key:"containerRef",ref:N},[(r(),p("svg",{width:M,height:W.value,class:"graph-svg"},[(r(!0),p(z,null,T(m.value.edges,o=>(r(),p("g",{key:`${o.from}-${o.to}`},[e("line",{x1:C(o.from,o.to,"start").x,y1:C(o.from,o.to,"start").y,x2:C(o.from,o.to,"end").x,y2:C(o.from,o.to,"end").y,stroke:"#94a3b8","stroke-width":X(o.strength),"stroke-opacity":"0.6","stroke-linecap":"round",class:"graph-edge",onMouseenter:f=>U(f,o),onMouseleave:Y},null,40,ft)]))),128)),(r(!0),p(z,null,T(m.value.nodes,o=>(r(),p("g",{key:o.id,transform:`translate(${w(o.id).x}, ${w(o.id).y})`,class:"graph-node",onClick:f=>J(o.id)},[t[5]||(t[5]=e("circle",{r:"30",fill:"rgba(0,0,0,0.07)",transform:"translate(2,3)"},null,-1)),e("circle",{r:"28",fill:q(o.id),stroke:"#fff","stroke-width":"2.5"},null,8,mt),e("text",vt,h(G(o.id)),1),e("circle",{cx:"20",cy:"-20",r:"6",fill:o.status==="running"?"#67C23A":"#c0c4cc",stroke:"#fff","stroke-width":"1.5"},null,8,gt),e("text",ht,h(o.name),1),e("text",yt,h(o.id),1)],8,pt))),128))],8,ut)),v.value.visible?(r(),p("div",{key:0,class:"edge-tooltip",style:ot({left:v.value.x+"px",top:v.value.y+"px"})},[e("div",_t,[e("span",xt,h(V(v.value.from)),1),t[6]||(t[6]=e("span",{class:"tooltip-sep"},"‚Üî",-1)),e("span",kt,h(V(v.value.to)),1)]),e("div",bt,[g(u,{size:"small",type:"info",effect:"plain"},{default:y(()=>[k(h(v.value.type),1)]),_:1}),g(u,{size:"small",effect:"plain"},{default:y(()=>[k(h(v.value.strength),1)]),_:1})]),v.value.label?(r(),p("div",wt,h(v.value.label),1)):A("",!0)],4)):A("",!0)],512))]),_:1})),[[x,b.value]]),m.value.nodes.length?(r(),S(i,{key:0,class:"legend-card"},{default:y(()=>[e("div",Ct,[t[7]||(t[7]=e("span",{class:"legend-title"},"Â∏ÉÂ±ÄËßÑÂàôÔºö",-1)),t[8]||(t[8]=e("span",{class:"legend-item"},"üîº ‰∏äÊñπ = ‰∏äÁ∫ß",-1)),t[9]||(t[9]=e("span",{class:"legend-item"},"‚ûñ ÂêåÂ±Ç = Âπ≥Á∫ßÂçè‰Ωú",-1)),t[10]||(t[10]=e("span",{class:"legend-item"},"üîΩ ‰∏ãÊñπ = ‰∏ãÁ∫ß",-1)),t[11]||(t[11]=e("span",{class:"legend-divider"}," | ",-1)),t[12]||(t[12]=e("span",{class:"legend-title"},"Á∫øÁ≤óÔºö",-1)),(r(),p(z,null,T(R,(o,f)=>e("span",{key:f,class:"legend-item"},[(r(),p("svg",Et,[e("line",{x1:"0",y1:"4",x2:"28",y2:"4",stroke:"#64748b","stroke-width":o,"stroke-linecap":"round"},null,8,Mt)])),k(" "+h(f),1)])),64)),t[13]||(t[13]=e("span",{class:"legend-divider"}," | ",-1)),t[14]||(t[14]=e("span",{class:"legend-item"},[e("svg",{width:"12",height:"12"},[e("circle",{cx:"6",cy:"6",r:"5",fill:"#67C23A"})]),k(" ËøêË°å‰∏≠ ")],-1)),t[15]||(t[15]=e("span",{class:"legend-item"},[e("svg",{width:"12",height:"12"},[e("circle",{cx:"6",cy:"6",r:"5",fill:"#c0c4cc"})]),k(" Á©∫Èó≤ ")],-1))])]),_:1})):A("",!0)])}}}),Rt=at(zt,[["__scopeId","data-v-9ab76592"]]);export{Rt as default};
