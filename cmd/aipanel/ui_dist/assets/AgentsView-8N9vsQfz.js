import{d as de,h as ue,c as m,b as n,a as t,w as s,k as F,i as f,j as v,g as k,r as u,o as i,f as a,F as x,l as C,m as z,v as $,p as re,u as pe,n as H,t as r,q as A,e as M,E as R}from"./index-Cud1_-r6.js";import{u as me}from"./agents-BwRiNvpY.js";import{b as fe}from"./index-B6ZRKErS.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ve={class:"agents-page"},ye={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"20px"}},_e={style:{display:"flex","align-items":"center",gap:"12px","margin-bottom":"12px"}},ge={style:{flex:"1"}},ke={style:{"font-weight":"600","font-size":"16px"}},xe={style:{"margin-bottom":"12px"}},Ce={style:{display:"flex",gap:"8px","flex-wrap":"wrap"}},Ie=["onClick"],we={key:0,style:{"text-align":"center",padding:"20px"}},Ve={style:{display:"flex","align-items":"center",gap:"12px"}},be={style:{flex:"1"}},he={style:{"font-weight":"600"}},ze={key:0,style:{"text-align":"center",padding:"20px"}},$e={style:{display:"flex","align-items":"center",gap:"12px"}},Ae={style:{flex:"1"}},Se={style:{"font-weight":"600"}},Ue={key:0,style:{"text-align":"center",padding:"20px"}},Le={style:{display:"flex","align-items":"center",gap:"12px"}},De={style:{flex:"1"}},Be={style:{"font-weight":"600"}},Ne={key:0,style:{"text-align":"center",padding:"20px"}},Ee={style:{display:"flex","align-items":"center",gap:"12px"}},Fe={style:{flex:"1"}},Me={style:{"font-weight":"600"}},Re=de({__name:"AgentsView",setup(je){const J=pe(),w=me(),y=k(!1),p=k(0),L=k(!1),K=["#409eff","#67c23a","#e6a23c","#f56c6c","#909399","#9b59b6","#1abc9c","#e74c3c"],o=re({id:"",name:"",description:"",avatarColor:"#409eff",modelId:"",channelIds:[],toolIds:[],skillIds:[]}),j=k([]),q=k([]),P=k([]),T=k([]);ue(()=>{w.fetchAll()});function Q(){(!o.id||o.id===O(o.name.slice(0,-1)))&&(o.id=O(o.name))}function O(d){return d.toLowerCase().replace(/[^a-z0-9\u4e00-\u9fff]+/g,"-").replace(/^-|-$/g,"").slice(0,30)}function W(){if(p.value===0&&(!o.name||!o.id)){R.warning("请填写名称和 ID");return}p.value++}function D(d,l){const S=d.indexOf(l);S===-1?d.push(l):d.splice(S,1)}async function X(){L.value=!0;try{await fe.create({id:o.id,name:o.name,description:o.description,modelId:o.modelId,channelIds:o.channelIds,toolIds:o.toolIds,skillIds:o.skillIds,avatarColor:o.avatarColor}),R.success("Agent 创建成功！"),y.value=!1,w.fetchAll(),J.push(`/agents/${o.id}`)}catch(d){R.error(d.response?.data?.error||"创建失败")}finally{L.value=!1}}function Y(d){return d==="running"?"success":d==="stopped"?"danger":"info"}function Z(d){return d==="running"?"运行中":d==="stopped"?"已停止":"空闲"}return(d,l)=>{const S=u("Plus"),G=u("el-icon"),c=u("el-button"),I=u("el-text"),g=u("el-tag"),ee=u("ChatDotRound"),V=u("el-card"),le=u("el-col"),te=u("el-row"),b=u("el-empty"),h=u("el-step"),se=u("el-steps"),B=u("el-input"),U=u("el-form-item"),oe=u("el-form"),ne=u("el-radio"),ie=u("el-radio-group"),N=u("el-checkbox"),E=u("el-checkbox-group"),ae=u("el-dialog");return i(),m("div",ve,[n("div",ye,[l[19]||(l[19]=n("h2",{style:{margin:"0"}},"AI 成员",-1)),t(c,{type:"primary",onClick:l[0]||(l[0]=e=>d.$router.push("/agents/new"))},{default:s(()=>[t(G,null,{default:s(()=>[t(S)]),_:1}),l[18]||(l[18]=a(" 新建 Agent ",-1))]),_:1})]),t(te,{gutter:16},{default:s(()=>[(i(!0),m(x,null,C(F(w).list,e=>(i(),f(le,{span:8,key:e.id},{default:s(()=>[t(V,{class:"agent-card",shadow:"hover"},{default:s(()=>[n("div",_e,[n("div",{class:"avatar-circle",style:H({background:e.avatarColor||"#409eff"})},r(e.name.charAt(0)),5),n("div",ge,[n("div",ke,r(e.name),1),t(I,{type:"info",size:"small"},{default:s(()=>[a(r(e.id),1)]),_:2},1024)]),t(g,{type:Y(e.status),size:"small"},{default:s(()=>[a(r(Z(e.status)),1)]),_:2},1032,["type"])]),n("div",xe,[t(g,{size:"small",type:"info",style:{"margin-right":"4px"}},{default:s(()=>[a(r(e.modelId||e.model||"未配置"),1)]),_:2},1024),(i(!0),m(x,null,C(e.channelIds||[],_=>(i(),f(g,{key:_,size:"small",style:{"margin-right":"4px"}},{default:s(()=>[a(r(_),1)]),_:2},1024))),128))]),e.description?(i(),f(I,{key:0,type:"info",size:"small",style:{display:"block","margin-bottom":"12px"}},{default:s(()=>[a(r(e.description),1)]),_:2},1024)):v("",!0),t(c,{type:"primary",style:{width:"100%"},onClick:_=>d.$router.push(`/agents/${e.id}`)},{default:s(()=>[t(G,null,{default:s(()=>[t(ee)]),_:1}),l[20]||(l[20]=a(" 进入 ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),!F(w).loading&&F(w).list.length===0?(i(),f(b,{key:0,description:"暂无 AI 成员，点击「新建 Agent」开始"})):v("",!0),t(ae,{modelValue:y.value,"onUpdate:modelValue":l[17]||(l[17]=e=>y.value=e),title:"新建 AI 成员",width:"680px","close-on-click-modal":!1},{footer:s(()=>[p.value>0?(i(),f(c,{key:0,onClick:l[16]||(l[16]=e=>p.value--)},{default:s(()=>[...l[26]||(l[26]=[a("上一步",-1)])]),_:1})):v("",!0),p.value<4?(i(),f(c,{key:1,type:"primary",onClick:W},{default:s(()=>[...l[27]||(l[27]=[a(" 下一步 ",-1)])]),_:1})):v("",!0),p.value===4?(i(),f(c,{key:2,type:"primary",onClick:X,loading:L.value},{default:s(()=>[...l[28]||(l[28]=[a(" 创建 Agent ",-1)])]),_:1},8,["loading"])):v("",!0)]),default:s(()=>[t(se,{active:p.value,"finish-status":"success",simple:"",style:{"margin-bottom":"24px"}},{default:s(()=>[t(h,{title:"基本信息"}),t(h,{title:"选择模型"}),t(h,{title:"消息通道"}),t(h,{title:"开启能力"}),t(h,{title:"安装 Skills"})]),_:1},8,["active"]),z(n("div",null,[t(oe,{model:o,"label-width":"90px"},{default:s(()=>[t(U,{label:"名称",required:""},{default:s(()=>[t(B,{modelValue:o.name,"onUpdate:modelValue":l[1]||(l[1]=e=>o.name=e),placeholder:"如：数据分析师",onInput:Q},null,8,["modelValue"])]),_:1}),t(U,{label:"ID"},{default:s(()=>[t(B,{modelValue:o.id,"onUpdate:modelValue":l[2]||(l[2]=e=>o.id=e),placeholder:"英文标识"},null,8,["modelValue"])]),_:1}),t(U,{label:"描述"},{default:s(()=>[t(B,{modelValue:o.description,"onUpdate:modelValue":l[3]||(l[3]=e=>o.description=e),type:"textarea",rows:2,placeholder:"简短描述这个 Agent 的职责"},null,8,["modelValue"])]),_:1}),t(U,{label:"头像颜色"},{default:s(()=>[n("div",Ce,[(i(),m(x,null,C(K,e=>n("div",{key:e,class:A(["color-swatch",{active:o.avatarColor===e}]),style:H({background:e}),onClick:_=>o.avatarColor=e},null,14,Ie)),64))])]),_:1})]),_:1},8,["model"])],512),[[$,p.value===0]]),z(n("div",null,[j.value.length===0?(i(),m("div",we,[t(b,{description:"暂无已配置模型","image-size":60}),t(c,{type:"primary",onClick:l[4]||(l[4]=e=>{d.$router.push("/config/models"),y.value=!1})},{default:s(()=>[...l[21]||(l[21]=[a(" 前往配置模型 ",-1)])]),_:1})])):v("",!0),t(ie,{modelValue:o.modelId,"onUpdate:modelValue":l[5]||(l[5]=e=>o.modelId=e),style:{width:"100%"}},{default:s(()=>[(i(!0),m(x,null,C(j.value,e=>(i(),f(V,{key:e.id,shadow:"hover",class:A(["select-card",{selected:o.modelId===e.id}]),onClick:_=>o.modelId=e.id},{default:s(()=>[n("div",Ve,[t(ne,{value:e.id,style:{"margin-right":"0"}},null,8,["value"]),n("div",be,[n("div",he,r(e.name),1),t(I,{type:"info",size:"small"},{default:s(()=>[a(r(e.provider)+" / "+r(e.model),1)]),_:2},1024)]),t(g,{type:e.status==="ok"?"success":e.status==="error"?"danger":"info",size:"small"},{default:s(()=>[a(r(e.status==="ok"?"✓ 已配置":e.status==="error"?"✗ 错误":"? 未测试"),1)]),_:2},1032,["type"])])]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["modelValue"]),t(c,{link:"",type:"primary",style:{"margin-top":"12px"},onClick:l[6]||(l[6]=e=>{d.$router.push("/config/models"),y.value=!1})},{default:s(()=>[...l[22]||(l[22]=[a(" + 配置新模型 ",-1)])]),_:1})],512),[[$,p.value===1]]),z(n("div",null,[q.value.length===0?(i(),m("div",ze,[t(b,{description:"暂无消息通道（可跳过）","image-size":60}),t(c,{link:"",type:"primary",onClick:l[7]||(l[7]=e=>{d.$router.push("/config/channels"),y.value=!1})},{default:s(()=>[...l[23]||(l[23]=[a(" 前往添加通道 ",-1)])]),_:1})])):v("",!0),t(E,{modelValue:o.channelIds,"onUpdate:modelValue":l[9]||(l[9]=e=>o.channelIds=e)},{default:s(()=>[(i(!0),m(x,null,C(q.value,e=>(i(),f(V,{key:e.id,shadow:"hover",class:A(["select-card",{selected:o.channelIds.includes(e.id)}]),onClick:_=>D(o.channelIds,e.id)},{default:s(()=>[n("div",$e,[t(N,{value:e.id,onClick:l[8]||(l[8]=M(()=>{},["stop"]))},null,8,["value"]),n("div",Ae,[n("div",Se,r(e.name),1),t(I,{type:"info",size:"small"},{default:s(()=>[a(r(e.type),1)]),_:2},1024)]),t(g,{type:e.enabled?"success":"info",size:"small"},{default:s(()=>[a(r(e.enabled?"启用":"停用"),1)]),_:2},1032,["type"])])]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["modelValue"])],512),[[$,p.value===2]]),z(n("div",null,[P.value.length===0?(i(),m("div",Ue,[t(b,{description:"暂无能力配置（可跳过）","image-size":60}),t(c,{link:"",type:"primary",onClick:l[10]||(l[10]=e=>{d.$router.push("/config/tools"),y.value=!1})},{default:s(()=>[...l[24]||(l[24]=[a(" 前往添加能力 ",-1)])]),_:1})])):v("",!0),t(E,{modelValue:o.toolIds,"onUpdate:modelValue":l[12]||(l[12]=e=>o.toolIds=e)},{default:s(()=>[(i(!0),m(x,null,C(P.value,e=>(i(),f(V,{key:e.id,shadow:"hover",class:A(["select-card",{selected:o.toolIds.includes(e.id)}]),onClick:_=>D(o.toolIds,e.id)},{default:s(()=>[n("div",Le,[t(N,{value:e.id,onClick:l[11]||(l[11]=M(()=>{},["stop"]))},null,8,["value"]),n("div",De,[n("div",Be,r(e.name),1),t(I,{type:"info",size:"small"},{default:s(()=>[a(r(e.type),1)]),_:2},1024)]),t(g,{type:e.status==="ok"?"success":"info",size:"small"},{default:s(()=>[a(r(e.status==="ok"?"✓":"?"),1)]),_:2},1032,["type"])])]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["modelValue"])],512),[[$,p.value===3]]),z(n("div",null,[T.value.length===0?(i(),m("div",Ne,[t(b,{description:"暂无已安装 Skills（可跳过）","image-size":60}),t(c,{link:"",type:"primary",onClick:l[13]||(l[13]=e=>{d.$router.push("/config/skills"),y.value=!1})},{default:s(()=>[...l[25]||(l[25]=[a(" 前往安装 Skill ",-1)])]),_:1})])):v("",!0),t(E,{modelValue:o.skillIds,"onUpdate:modelValue":l[15]||(l[15]=e=>o.skillIds=e)},{default:s(()=>[(i(!0),m(x,null,C(T.value,e=>(i(),f(V,{key:e.id,shadow:"hover",class:A(["select-card",{selected:o.skillIds.includes(e.id)}]),onClick:_=>D(o.skillIds,e.id)},{default:s(()=>[n("div",Ee,[t(N,{value:e.id,onClick:l[14]||(l[14]=M(()=>{},["stop"]))},null,8,["value"]),n("div",Fe,[n("div",Me,r(e.name),1),t(I,{type:"info",size:"small"},{default:s(()=>[a(r(e.description),1)]),_:2},1024)]),t(g,{size:"small",type:"info"},{default:s(()=>[a("v"+r(e.version),1)]),_:2},1024)])]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["modelValue"])],512),[[$,p.value===4]])]),_:1},8,["modelValue"])])}}}),Ge=ce(Re,[["__scopeId","data-v-cf7c7777"]]);export{Ge as default};
