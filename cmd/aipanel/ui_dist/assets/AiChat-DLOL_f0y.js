import{d as Be,e as m,D as Le,i as Ee,c as a,f as N,n as Je,s as P,a as x,w as j,S as Re,b as o,k as d,t as h,F as C,m as T,h as X,p as Pe,G as Ue,g as re,z as He,H as U,r as L,o as l,j as ce}from"./index-JBrLcEDh.js";import{n as ze,i as qe}from"./index-B6SLQW8T.js";import{_ as Ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ve={key:0,class:"drag-overlay"},We={key:0,class:"history-loading"},Ge={key:1,class:"chat-empty"},Xe={key:0,class:"welcome-msg"},Ye={key:1,class:"examples"},Qe=["onClick"],Ze={key:0,class:"msg-row user"},et={class:"msg-bubble user"},tt={key:0,class:"msg-images"},st=["src","onClick"],nt={class:"msg-text"},ot={key:1,class:"msg-row assistant"},lt={class:"msg-col"},at=["open"],it={class:"thinking-summary"},rt={class:"thinking-len"},ct={class:"thinking-content"},ut={key:1,class:"tool-timeline"},dt=["onClick"],pt={class:"tool-step-header"},ht={key:0,class:"tool-spin"},ft={key:1},vt={key:2},_t={key:3},gt={class:"tool-step-icon"},mt={class:"tool-step-name"},yt={key:0,class:"tool-step-summary"},kt={key:1,class:"tool-step-dur"},xt={class:"tool-step-chevron"},bt={key:0,class:"tool-section"},wt={class:"tool-pre"},Ct={key:1,class:"tool-section"},$t={class:"tool-pre result"},Tt={class:"msg-bubble assistant"},St=["innerHTML"],It={key:1,class:"apply-card"},Dt={class:"apply-preview"},Mt={class:"apply-key"},At={class:"apply-val"},Nt=["onClick"],jt={class:"msg-actions"},Ft=["onClick","title"],Ot=["onClick"],Bt=["onClick"],Lt={key:2,class:"option-chips"},Et=["onClick"],Jt={key:2,class:"msg-row system"},Rt={class:"msg-system"},Pt={key:2,class:"msg-row assistant"},Ut={class:"msg-col"},Ht={key:0,class:"thinking-block",open:""},zt={class:"thinking-summary"},qt={class:"thinking-content"},Kt={key:1,class:"tool-timeline"},Vt=["onClick"],Wt={class:"tool-step-header"},Gt={key:0,class:"tool-spin"},Xt={key:1},Yt={key:2},Qt={class:"tool-step-icon"},Zt={class:"tool-step-name"},es={key:0,class:"tool-step-summary"},ts={key:1,class:"tool-step-dur"},ss={class:"tool-step-chevron"},ns={key:0,class:"tool-section"},os={class:"tool-pre"},ls={key:1,class:"tool-section"},as={class:"tool-pre result"},is={key:2,class:"msg-bubble assistant"},rs={key:0,class:"typing-dots"},cs=["innerHTML"],us={key:2,class:"blink"},ds=["src"],ps={class:"chat-input-area"},hs={key:0,class:"attachments-bar"},fs=["src"],vs=["onClick"],_s={class:"attach-file-icon"},gs={class:"attach-file-name"},ms={class:"attach-file-size"},ys=["onClick"],ks={class:"input-row"},xs={class:"textarea-wrap"},bs=["placeholder","disabled","onKeydown"],ws={class:"input-actions"},Cs={class:"icon-btn",title:"é™„åŠ æ–‡ä»¶ï¼ˆå›¾ç‰‡/ä»£ç /æ–‡æœ¬ï¼‰"},$s=["disabled"],Ts={key:0,class:"spinner"},Ss={key:1},Is=Be({__name:"AiChat",props:{agentId:{},sessionId:{},context:{},scenario:{},skillId:{},placeholder:{},welcomeMessage:{},examples:{default:()=>[]},showThinking:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},bgColor:{},height:{},initialMessages:{},applyable:{type:Boolean,default:!1}},emits:["message","response","apply","session-change","streaming-change"],setup(b,{expose:ue,emit:de}){const y=b,E=de,_=m(y.initialMessages?[...y.initialMessages]:[]),F=m(""),D=m([]),M=m([]),$=m(!1);Le($,t=>E("streaming-change",t));const k=m(""),O=m(""),S=m([]),J=m(!1);let R=0;const H=m(null),z=m(""),A=m(y.sessionId),B=m(!1),q=m(),I=m(),pe=He(()=>({height:y.height??"100%","--bg":y.bgColor??"transparent"}));function w(){U(()=>{q.value&&(q.value.scrollTop=q.value.scrollHeight)})}function he(){I.value&&(I.value.style.height="auto",I.value.style.height=Math.min(I.value.scrollHeight,160)+"px")}function K(t){F.value=t,U(()=>I.value?.focus())}function Z(t){try{return JSON.stringify(JSON.parse(t),null,2)}catch{return t}}function fe(t){navigator.clipboard?.writeText(t);const e=_.value.findIndex(n=>n.text===t);H.value=e,setTimeout(()=>{H.value=null},1500)}function ve(t){for(let e=t-1;e>=0;e--){const n=_.value[e];if(n&&n.role==="user"){const c=n.text,f=n.images??[];_.value.splice(e,_.value.length-e),Q(c,f);return}}}function _e(t){z.value=t}function ee(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/```(\w*)\n([\s\S]*?)```/g,(n,c,f)=>`<pre class="code-block${c?" lang-"+c:""}"><code>${f}</code></pre>`).replace(/`([^`]+)`/g,'<code class="inline-code">$1</code>').replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/\[(.+?)\]\((https?:\/\/[^\)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>').replace(/^### (.+)$/gm,"<h3>$1</h3>").replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/^[-*] (.+)$/gm,"<li>$1</li>").replace(/^\d+\. (.+)$/gm,"<li>$1</li>").replace(/(<li>[\s\S]+?<\/li>)(\n(?!<li>)|$)/g,"<ul>$1</ul>$2").replace(/([^>])\n([^<])/g,"$1<br>$2"):""}function ge(t){const e=t.split(`
`),n=[],c=/^([ğŸ™ğŸ˜„ğŸŒğŸ›ğŸ“šğŸ¨ğŸ’¼ğŸ¤–âš½ğŸ¯âœ…âŒğŸ”¥ğŸ’¡ğŸğŸš€ğŸŒŸğŸ’ğŸªğŸ­ğŸ¬ğŸ¤]|[\u{1F300}-\u{1FFFF}]|[\u{2600}-\u{27BF}])\s+(.{4,40})/u;for(const f of e){const u=f.replace(/^[-*â€¢]\s*/,"").trim();if(u.match(c)){const g=u.replace(/[ï¼š:ã€‚ï¼Œ,]$/,"").trim();g.length>=5&&n.push(g)}}return n.slice(0,5)}function me(t){return t?/\{[\s\S]{30,}\}/.test(t)&&(t.includes('"name"')||t.includes('"identity"')||t.includes('"soul"')||t.includes('"IDENTITY"')||t.includes('"SOUL"')):!1}function ye(t){const e=se(t.text);console.log("[AiChat] manualApply result:",e),e?(t.applyData=e,U(()=>E("apply",e))):alert("æœªèƒ½ä»æ¶ˆæ¯ä¸­æå–åˆ°é…ç½® JSONï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶")}function te(t,e=0){const n=t.indexOf("{",e);if(n===-1)return null;let c=0,f=!1,u=!1;for(let p=n;p<t.length;p++){const g=t[p];if(u){u=!1;continue}if(g==="\\"&&f){u=!0;continue}if(g==='"'){f=!f;continue}if(!f){if(g==="{")c++;else if(g==="}"&&(c--,c===0))return{raw:t.slice(n,p+1),end:p+1}}}return null}function se(t){const e=/```(?:json)?\s*\n?([\s\S]*?)```/g,n=[];let c;for(;(c=e.exec(t))!==null;){const p=(c[1]??"").trim();p.startsWith("{")&&n.push(p)}for(let p=n.length-1;p>=0;p--){const g=n[p],s=te(g);if(!s)continue;const r=V(s.raw)??V(ne(s.raw));if(r)return r}const f=[];let u=0;for(;u<t.length;){const p=te(t,u);if(!p)break;f.push(p.raw),u=p.end}for(let p=f.length-1;p>=0;p--){const g=f[p],s=V(g)??V(ne(g));if(s)return s}return null}function V(t){try{const e=JSON.parse(t);if(e&&typeof e=="object"&&!Array.isArray(e)){const n=["name","id","description","identity","soul","IDENTITY","SOUL","NAME","DESCRIPTION"];if(Object.keys(e).some(c=>n.includes(c)))return e}}catch{}return null}function ne(t){let e="",n=!1,c=!1;for(let f=0;f<t.length;f++){const u=t[f];if(c){e+=u,c=!1;continue}if(u==="\\"&&n){e+=u,c=!0;continue}if(u==='"'){n=!n,e+=u;continue}if(n&&u===`
`){e+="\\n";continue}if(n&&u==="\r"){e+="\\r";continue}e+=u}return e}const ke={exec:"âš¡",bash:"âš¡",read:"ğŸ“–",write:"âœï¸",edit:"âœï¸",web_search:"ğŸŒ",web_fetch:"ğŸŒ",browser:"ğŸŒ",agent_spawn:"ğŸš€",agent_tasks:"ğŸ“‹",agent_kill:"ğŸ›‘",agent_result:"ğŸ“Š",project_read:"ğŸ“",project_write:"ğŸ“",project_list:"ğŸ“",project_create:"ğŸ“",project_glob:"ğŸ“",memory_search:"ğŸ§ ",memory_get:"ğŸ§ ",image:"ğŸ–¼ï¸",tts:"ğŸ”Š",cron:"â±ï¸"};function oe(t){return ke[t]??"âš™ï¸"}function le(t,e){try{const n=JSON.parse(e);if(t==="exec"||t==="bash")return(n.command??"").slice(0,60);if(t==="read")return n.file_path??n.path??"";if(t==="write")return(n.file_path??n.path??"")+(n.content?` (${n.content.length}B)`:"");if(t==="edit")return n.file_path??n.path??"";if(t==="web_search")return n.query??"";if(t==="web_fetch")return n.url??"";if(t==="agent_spawn")return`â†’ ${n.agentId}: ${(n.task??"").slice(0,40)}`;if(t==="project_read"||t==="project_write")return n.path??"";if(t==="memory_search")return n.query??""}catch{}return""}const xe=new Set(["txt","md","markdown","js","ts","jsx","tsx","vue","go","py","rs","java","kt","swift","html","css","scss","less","json","yaml","yml","toml","ini","cfg","env","sh","bash","zsh","fish","ps1","bat","cmd","dockerfile","makefile","sql","graphql","proto","xml","svg","gitignore","gitattributes"]);function ae(t){const e=t.split(".").pop()?.toLowerCase()??"";return xe.has(e)}function be(t){const e=t.split(".").pop()?.toLowerCase()??"";return{js:"ğŸŸ¨",ts:"ğŸ”µ",vue:"ğŸ’š",go:"ğŸ¹",py:"ğŸ",rs:"ğŸ¦€",html:"ğŸŒ",css:"ğŸ¨",json:"ğŸ“‹",md:"ğŸ“",sh:"âš¡",sql:"ğŸ—„ï¸",yaml:"âš™ï¸",yml:"âš™ï¸",dockerfile:"ğŸ³"}[e]??"ğŸ“„"}function we(t){return t<1024?`${t}B`:t<1024*1024?`${(t/1024).toFixed(1)}KB`:`${(t/1024/1024).toFixed(1)}MB`}function Ce(t){const e=t.clipboardData?.items;if(e){for(const n of Array.from(e))if(n.type.startsWith("image/")){t.preventDefault();const c=n.getAsFile();c&&Y(c)}}}function $e(t){t.preventDefault(),R++,J.value=!0}function Te(t){t.preventDefault(),R--,R<=0&&(R=0,J.value=!1)}function Se(t){R=0,J.value=!1;const e=t.dataTransfer?.files;if(e)for(const n of Array.from(e))n.type.startsWith("image/")?Y(n):ae(n.name)&&ie(n)}function Ie(t){const e=t.target.files;if(e){for(const n of Array.from(e))n.type.startsWith("image/")?Y(n):ae(n.name)&&ie(n);t.target.value=""}}function ie(t){const e=new FileReader;e.onload=()=>{typeof e.result=="string"&&M.value.push({name:t.name,content:e.result})},e.readAsText(t)}function Y(t){const e=new FileReader;e.onload=()=>{typeof e.result=="string"&&D.value.push(e.result)},e.readAsDataURL(t)}function De(t){D.value.splice(t,1)}function W(){const t=F.value.trim(),e=[...D.value],n=[...M.value];if(!t&&!e.length&&!n.length||$.value)return;let c=t;if(n.length>0){const f=n.map(u=>{const p=u.name.split(".").pop()??"text";return`

ğŸ“ **${u.name}**
\`\`\`${p}
${u.content}
\`\`\``}).join("");c=t?t+f:f.trimStart()}F.value="",D.value=[],M.value=[],U(()=>{I.value&&(I.value.style.height="auto")}),E("message",c,e),Q(c,e)}function Q(t,e,n=!1){n||(_.value.push({role:"user",text:t,images:e.length?e:void 0}),w()),$.value=!0,k.value="",O.value="",S.value=[];const c={role:"assistant",text:"",toolCalls:[]};_.value.push(c),n&&w();const f=_.value.length-1;let u="",p;if(A.value)p=void 0;else{const s=_.value.slice(0,-1).filter(r=>(r.role==="user"||r.role==="assistant")&&r.text).slice(-20).map(r=>({role:r.role,content:r.text}));p=s.length>0?s:void 0}const g={sessionId:A.value,context:y.context,scenario:y.scenario,skillId:y.skillId,images:e.length?e:void 0,history:p};ze(y.agentId,t,s=>{switch(s.type){case"thinking_delta":O.value+=s.text,w();break;case"text":case"text_delta":k.value+=s.text,w();break;case"tool_call":{const r={id:s.tool_call?.id??String(Date.now()),name:s.tool_call?.name??"tool",input:s.tool_call?.input?JSON.stringify(s.tool_call.input):void 0,status:"running",_startedAt:Date.now(),_expanded:!1};_.value[f].toolCalls.push(r),S.value.push(r),u=r.id,w();break}case"tool_result":{const r=_.value[f].toolCalls?.find(i=>i.id===u);if(r){if(r.result=s.text,r.status="done",r._startedAt){const v=Date.now()-r._startedAt;r.duration=v<1e3?`${v}ms`:`${(v/1e3).toFixed(1)}s`}const i=S.value.find(v=>v.id===u);i&&(i.result=r.result,i.status="done",i.duration=r.duration)}w();break}case"done":case"error":{if(s.type==="done"&&s.sessionId){const v=!A.value;A.value=s.sessionId,v&&E("session-change",s.sessionId)}const r=_.value[f];if(r.text=k.value,r.thinking=O.value||void 0,y.applyable){const v=se(k.value);v?(r.applyData=v,console.log("[AiChat] applyData extracted:",v)):console.log("[AiChat] no applyData found in text length:",k.value.length)}const i=ge(k.value);if(i.length>=2&&(r.options=i),s.type==="error"){r.text=`[é”™è¯¯] ${s.error}`;const v=r.toolCalls?.find(G=>G.status==="running");v&&(v.status="error")}$.value=!1,k.value="",O.value="",S.value=[],E("response",r.text),w();break}}},g)}function Me(){_.value=[]}function Ae(t){_.value.push(t),w()}async function Ne(t){A.value=t,_.value=[],B.value=!0;try{const n=(await qe.get(y.agentId,t)).data.messages??[],c=[];n.some(u=>u.isCompact||u.role==="compaction")&&c.push({role:"system",text:"æ›´æ—©çš„å†…å®¹å·²å‹ç¼©"});for(const u of n)u.role!=="compaction"&&c.push({role:u.role,text:u.text});_.value=c,w()}catch(e){e?.response?.status===404?_.value=[]:(console.error("[AiChat] resumeSession failed",e),_.value=[{role:"system",text:"å†å²åŠ è½½å¤±è´¥ï¼Œç»§ç»­å¯¹è¯ä»å¯æ¥ç»­"}])}finally{B.value=!1}}function je(){A.value=void 0,_.value=[]}function Fe(t){K(t),U(W)}function Oe(t){Q(t,[],!0)}return ue({clearMessages:Me,appendMessage:Ae,sendText:Fe,sendSilent:Oe,fillInput:K,messages:_,streaming:$,currentSessionId:A,resumeSession:Ne,startNewSession:je}),Ee(()=>{w()}),(t,e)=>{const n=L("ChatRound"),c=L("el-icon"),f=L("Check"),u=L("CopyDocument"),p=L("Setting"),g=L("Paperclip");return l(),a("div",{class:P(["ai-chat",{compact:b.compact,"has-bg":b.bgColor,"drag-active":J.value}]),style:Je(pe.value),onDragenter:N($e,["prevent"]),onDragover:e[4]||(e[4]=N(()=>{},["prevent"])),onDragleave:Te,onDrop:N(Se,["prevent","stop"])},[x(Re,{name:"drag-fade"},{default:j(()=>[J.value?(l(),a("div",Ve,[...e[5]||(e[5]=[o("div",{class:"drag-overlay-content"},[o("div",{class:"drag-overlay-icon"},"ğŸ“"),o("div",{class:"drag-overlay-title"},"æ¾å¼€ä»¥é™„åŠ æ–‡ä»¶"),o("div",{class:"drag-overlay-hint"},"æ”¯æŒå›¾ç‰‡ Â· ä»£ç  Â· æ–‡æœ¬æ–‡ä»¶")],-1)])])):d("",!0)]),_:1}),o("div",{class:"chat-messages",ref_key:"msgListRef",ref:q},[B.value?(l(),a("div",We,[...e[6]||(e[6]=[o("div",{class:"history-loading-dots"},[o("span"),o("span"),o("span")],-1),o("div",{class:"history-loading-text"},"åŠ è½½å†å²å¯¹è¯â€¦",-1)])])):d("",!0),!_.value.length&&!B.value?(l(),a("div",Ge,[b.welcomeMessage?(l(),a("div",Xe,h(b.welcomeMessage),1)):d("",!0),b.examples.length?(l(),a("div",Ye,[(l(!0),a(C,null,T(b.examples,(s,r)=>(l(),a("div",{key:r,class:"example-chip",onClick:i=>K(s)},h(s),9,Qe))),128))])):d("",!0)])):d("",!0),(l(!0),a(C,null,T(_.value,(s,r)=>(l(),a(C,{key:r},[s.role==="user"?(l(),a("div",Ze,[o("div",et,[s.images?.length?(l(),a("div",tt,[(l(!0),a(C,null,T(s.images,(i,v)=>(l(),a("img",{key:v,src:i,class:"msg-img",onClick:G=>_e(i)},null,8,st))),128))])):d("",!0),o("div",nt,h(s.text),1)])])):s.role==="assistant"?(l(),a("div",ot,[o("div",lt,[s.thinking?(l(),a("details",{key:0,class:"thinking-block",open:b.showThinking},[o("summary",it,[x(c,{class:"thinking-icon"},{default:j(()=>[x(n)]),_:1}),e[7]||(e[7]=X(" æ€è€ƒè¿‡ç¨‹ ",-1)),o("span",rt,h(s.thinking.length)+" å­—ç¬¦",1)]),o("pre",ct,h(s.thinking),1)],8,at)):d("",!0),s.toolCalls?.length?(l(),a("div",ut,[(l(!0),a(C,null,T(s.toolCalls,(i,v)=>(l(),a("div",{key:v,class:P(["tool-step",i.status]),onClick:G=>i._expanded=!i._expanded},[o("div",pt,[o("span",{class:P(["tool-step-dot",i.status])},[i.status==="running"?(l(),a("span",ht,"âŸ³")):i.status==="done"?(l(),a("span",ft,"âœ“")):i.status==="error"?(l(),a("span",vt,"âœ—")):(l(),a("span",_t,"â—‹"))],2),o("span",gt,h(oe(i.name)),1),o("code",mt,h(i.name),1),i.input?(l(),a("span",yt,h(le(i.name,i.input)),1)):d("",!0),e[8]||(e[8]=o("span",{class:"tool-step-flex"},null,-1)),i.duration?(l(),a("span",kt,h(i.duration),1)):d("",!0),o("span",xt,h(i._expanded?"â–²":"â–¼"),1)]),i._expanded?(l(),a("div",{key:0,class:"tool-step-body",onClick:e[0]||(e[0]=N(()=>{},["stop"]))},[i.input?(l(),a("div",bt,[e[9]||(e[9]=o("div",{class:"tool-label"},"INPUT",-1)),o("pre",wt,h(Z(i.input)),1)])):d("",!0),i.result?(l(),a("div",Ct,[e[10]||(e[10]=o("div",{class:"tool-label"},"OUTPUT",-1)),o("pre",$t,h(i.result.slice(0,3e3))+h(i.result.length>3e3?`
â€¦ (æˆªæ–­)`:""),1)])):d("",!0)])):d("",!0)],10,dt))),128))])):d("",!0),o("div",Tt,[s.text?(l(),a("div",{key:0,class:"msg-text",innerHTML:ee(s.text)},null,8,St)):d("",!0),s.applyData&&y.applyable?(l(),a("div",It,[o("div",Dt,[(l(!0),a(C,null,T(s.applyData,(i,v)=>(l(),a("div",{key:v,class:"apply-row"},[o("span",Mt,h(v),1),o("span",At,h(String(i).slice(0,60))+h(String(i).length>60?"â€¦":""),1)]))),128))]),o("button",{class:"apply-btn",onClick:i=>t.$emit("apply",s.applyData)}," åº”ç”¨åˆ°è¡¨å• â†™ ",8,Nt)])):d("",!0),o("div",jt,[o("button",{class:"act-btn",onClick:i=>fe(s.text),title:H.value===r?"å·²å¤åˆ¶":"å¤åˆ¶"},[H.value===r?(l(),ce(c,{key:0},{default:j(()=>[x(f)]),_:1})):(l(),ce(c,{key:1},{default:j(()=>[x(u)]),_:1}))],8,Ft),o("button",{class:"act-btn",onClick:i=>ve(r),title:"é‡è¯•"},"â†º",8,Ot),y.applyable&&!s.applyData&&me(s.text)?(l(),a("button",{key:0,class:"act-btn apply-manual-btn",onClick:i=>ye(s),title:"æ£€æµ‹åˆ°é…ç½® JSONï¼Œç‚¹å‡»åº”ç”¨"},[x(c,null,{default:j(()=>[x(p)]),_:1}),e[11]||(e[11]=X(" åº”ç”¨é…ç½® ",-1))],8,Bt)):d("",!0)])]),s.options&&s.options.length?(l(),a("div",Lt,[(l(!0),a(C,null,T(s.options,(i,v)=>(l(),a("button",{key:v,class:"option-chip",onClick:G=>K(i)},h(i),9,Et))),128))])):d("",!0)])])):s.role==="system"?(l(),a("div",Jt,[o("div",Rt,h(s.text),1)])):d("",!0)],64))),128)),$.value?(l(),a("div",Pt,[o("div",Ut,[O.value&&b.showThinking?(l(),a("details",Ht,[o("summary",zt,[x(c,{class:"thinking-icon"},{default:j(()=>[x(n)]),_:1}),e[12]||(e[12]=X(" æ€è€ƒä¸­â€¦ ",-1))]),o("pre",qt,[X(h(O.value),1),e[13]||(e[13]=o("span",{class:"blink"},"â–Š",-1))])])):d("",!0),S.value.length?(l(),a("div",Kt,[(l(!0),a(C,null,T(S.value,(s,r)=>(l(),a("div",{key:r,class:P(["tool-step",s.status]),onClick:i=>s._expanded=!s._expanded},[o("div",Wt,[o("span",{class:P(["tool-step-dot",s.status])},[s.status==="running"?(l(),a("span",Gt,"âŸ³")):s.status==="done"?(l(),a("span",Xt,"âœ“")):s.status==="error"?(l(),a("span",Yt,"âœ—")):d("",!0)],2),o("span",Qt,h(oe(s.name)),1),o("code",Zt,h(s.name),1),s.input?(l(),a("span",es,h(le(s.name,s.input)),1)):d("",!0),e[14]||(e[14]=o("span",{class:"tool-step-flex"},null,-1)),s.duration?(l(),a("span",ts,h(s.duration),1)):d("",!0),o("span",ss,h(s._expanded?"â–²":"â–¼"),1)]),s._expanded?(l(),a("div",{key:0,class:"tool-step-body",onClick:e[1]||(e[1]=N(()=>{},["stop"]))},[s.input?(l(),a("div",ns,[e[15]||(e[15]=o("div",{class:"tool-label"},"INPUT",-1)),o("pre",os,h(Z(s.input)),1)])):d("",!0),s.result?(l(),a("div",ls,[e[16]||(e[16]=o("div",{class:"tool-label"},"OUTPUT",-1)),o("pre",as,h(s.result.slice(0,3e3)),1)])):d("",!0)])):d("",!0)],10,Vt))),128))])):d("",!0),k.value||!S.value.length?(l(),a("div",is,[!k.value&&!S.value.length?(l(),a("div",rs,[...e[17]||(e[17]=[o("span",null,null,-1),o("span",null,null,-1),o("span",null,null,-1)])])):d("",!0),k.value?(l(),a("div",{key:1,class:"msg-text",innerHTML:ee(k.value)},null,8,cs)):d("",!0),k.value?(l(),a("span",us,"â–Š")):d("",!0)])):d("",!0)])])):d("",!0)],512),z.value?(l(),a("div",{key:0,class:"img-preview-mask",onClick:e[2]||(e[2]=s=>z.value="")},[o("img",{src:z.value,class:"img-preview-full"},null,8,ds)])):d("",!0),o("div",ps,[D.value.length||M.value.length?(l(),a("div",hs,[(l(!0),a(C,null,T(D.value,(s,r)=>(l(),a("div",{key:"img-"+r,class:"attach-thumb"},[o("img",{src:s},null,8,fs),o("button",{class:"remove-attach",onClick:i=>De(r)},"Ã—",8,vs)]))),128)),(l(!0),a(C,null,T(M.value,(s,r)=>(l(),a("div",{key:"file-"+r,class:"attach-file-chip"},[o("span",_s,h(be(s.name)),1),o("span",gs,h(s.name),1),o("span",ms,h(we(s.content.length)),1),o("button",{class:"attach-file-remove",onClick:i=>M.value.splice(r,1)},"Ã—",8,ys)]))),128))])):d("",!0),o("div",ks,[o("div",xs,[Pe(o("textarea",{ref_key:"inputRef",ref:I,"onUpdate:modelValue":e[3]||(e[3]=s=>F.value=s),placeholder:b.placeholder||"è¾“å…¥æ¶ˆæ¯â€¦ æ”¯æŒæ‹–æ‹½å›¾ç‰‡æˆ–æ–‡ä»¶ (Ctrl+Enter å‘é€)",disabled:$.value||B.value,rows:"1",class:"chat-textarea",onKeydown:[re(N(W,["ctrl","prevent"]),["enter"]),re(N(W,["meta","prevent"]),["enter"])],onPaste:Ce,onInput:he},null,40,bs),[[Ue,F.value]])]),o("div",ws,[o("label",Cs,[x(c,null,{default:j(()=>[x(g)]),_:1}),o("input",{type:"file",multiple:"",hidden:"",onChange:Ie},null,32)]),o("button",{class:"send-btn",disabled:$.value||B.value||!F.value.trim()&&!D.value.length&&!M.value.length,onClick:W},[$.value?(l(),a("span",Ts)):(l(),a("span",Ss,"â†‘"))],8,$s)])]),e[18]||(e[18]=o("div",{class:"input-hint"},"Ctrl+Enter å‘é€ Â· æ”¯æŒæ‹–æ‹½å›¾ç‰‡/æ–‡ä»¶",-1))])],38)}}}),Ns=Ke(Is,[["__scopeId","data-v-797df8d8"]]);export{Ns as A};
