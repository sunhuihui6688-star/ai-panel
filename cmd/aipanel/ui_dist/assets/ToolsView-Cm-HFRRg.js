import{t as c}from"./index-BclxA8EE.js";import{d as D,i as M,c as O,b as i,a as e,w as a,h as d,e as g,r as s,o as B,t as k,j as R,k as F,q as G,E as u,x as H}from"./index-CGA_a80X.js";const J={class:"tools-page"},Q={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"8px"}},W={style:{margin:"0"}},X={style:{"font-size":"12px",color:"#909399"}},le=D({__name:"ToolsView",setup(Y){const x=g([]),r=g(!1),_=g(""),V=g(!1),o=G({id:"",name:"",type:"brave_search",apiKey:"",baseUrl:"",enabled:!0});M(y);async function y(){try{const n=await c.list();x.value=n.data}catch{}}function K(){_.value="",Object.assign(o,{id:"",name:"",type:"brave_search",apiKey:"",baseUrl:"",enabled:!0}),r.value=!0}function E(n){_.value=n.id,Object.assign(o,{...n}),r.value=!0}async function h(){if(!o.name||!o.type){u.warning("请填写必要字段");return}o.id||(o.id=o.type+"-"+Date.now().toString(36)),V.value=!0;try{_.value?await c.update(_.value,{...o}):await c.create({...o,status:"untested"}),u.success("保存成功"),r.value=!1,y()}catch(n){u.error(n.response?.data?.error||"保存失败")}finally{V.value=!1}}async function I(n){try{await c.update(n.id,{enabled:n.enabled})}catch{u.error("更新失败")}}async function S(n){try{await c.test(n.id),u.success("测试成功"),y()}catch{u.error("测试失败")}}async function T(n){try{await H.confirm(`确定删除 "${n.name}"？`,"确认删除",{type:"warning"}),await c.delete(n.id),u.success("已删除"),y()}catch{}}return(n,l)=>{const A=s("SetUp"),U=s("el-icon"),P=s("Plus"),p=s("el-button"),m=s("el-table-column"),C=s("el-tag"),z=s("el-switch"),$=s("el-table"),j=s("el-card"),w=s("el-option"),q=s("el-select"),f=s("el-form-item"),v=s("el-input"),L=s("el-form"),N=s("el-dialog");return B(),O("div",J,[i("div",Q,[i("h2",W,[e(U,{style:{"vertical-align":"-2px","margin-right":"6px"}},{default:a(()=>[e(A)]),_:1}),l[8]||(l[8]=d("能力配置 ",-1)),l[9]||(l[9]=i("span",{style:{"font-size":"12px",color:"#64748b","font-weight":"400"}},"（全局，所有成员共享）",-1))]),e(p,{type:"primary",onClick:K},{default:a(()=>[e(U,null,{default:a(()=>[e(P)]),_:1}),l[10]||(l[10]=d(" 添加能力 ",-1))]),_:1})]),l[16]||(l[16]=i("p",{style:{margin:"0 0 16px",color:"#64748b","font-size":"13px"}},[d(" 配置"),i("strong",null,"所有 AI 成员"),d("都能使用的工具 API Key，例如 Brave Search、ElevenLabs 等。"),i("br"),d(" 如需配置"),i("strong",null,"某个成员专属"),d("的 API Key 或 Token，请进入该成员的「环境变量」Tab。 ")],-1)),e(j,{shadow:"hover"},{default:a(()=>[e($,{data:x.value,stripe:""},{default:a(()=>[e(m,{prop:"name",label:"名称","min-width":"160"}),e(m,{label:"类型",width:"140"},{default:a(({row:t})=>[e(C,{size:"small"},{default:a(()=>[d(k(t.type),1)]),_:2},1024)]),_:1}),e(m,{label:"API Key","min-width":"180"},{default:a(({row:t})=>[i("code",X,k(t.apiKey),1)]),_:1}),e(m,{label:"启用",width:"80"},{default:a(({row:t})=>[e(z,{modelValue:t.enabled,"onUpdate:modelValue":b=>t.enabled=b,onChange:b=>I(t),size:"small"},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(m,{label:"状态",width:"80"},{default:a(({row:t})=>[e(C,{type:t.status==="ok"?"success":"info",size:"small"},{default:a(()=>[d(k(t.status==="ok"?"✓":"?"),1)]),_:2},1032,["type"])]),_:1}),e(m,{label:"操作",width:"180"},{default:a(({row:t})=>[e(p,{size:"small",onClick:b=>S(t)},{default:a(()=>[...l[11]||(l[11]=[d("测试",-1)])]),_:1},8,["onClick"]),e(p,{size:"small",onClick:b=>E(t)},{default:a(()=>[...l[12]||(l[12]=[d("编辑",-1)])]),_:1},8,["onClick"]),e(p,{size:"small",type:"danger",onClick:b=>T(t)},{default:a(()=>[...l[13]||(l[13]=[d("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),e(N,{modelValue:r.value,"onUpdate:modelValue":l[7]||(l[7]=t=>r.value=t),title:_.value?"编辑能力":"添加能力",width:"520px"},{footer:a(()=>[e(p,{onClick:l[6]||(l[6]=t=>r.value=!1)},{default:a(()=>[...l[14]||(l[14]=[d("取消",-1)])]),_:1}),e(p,{type:"primary",onClick:h,loading:V.value},{default:a(()=>[...l[15]||(l[15]=[d("保存",-1)])]),_:1},8,["loading"])]),default:a(()=>[e(L,{model:o,"label-width":"100px"},{default:a(()=>[e(f,{label:"类型",required:""},{default:a(()=>[e(q,{modelValue:o.type,"onUpdate:modelValue":l[0]||(l[0]=t=>o.type=t),style:{width:"100%"}},{default:a(()=>[e(w,{label:"Brave Search",value:"brave_search"}),e(w,{label:"ElevenLabs",value:"elevenlabs"}),e(w,{label:"自定义",value:"custom"})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"名称",required:""},{default:a(()=>[e(v,{modelValue:o.name,"onUpdate:modelValue":l[1]||(l[1]=t=>o.name=t),placeholder:"如 Brave Search"},null,8,["modelValue"])]),_:1}),e(f,{label:"ID"},{default:a(()=>[e(v,{modelValue:o.id,"onUpdate:modelValue":l[2]||(l[2]=t=>o.id=t),placeholder:"唯一标识"},null,8,["modelValue"])]),_:1}),e(f,{label:"API Key",required:""},{default:a(()=>[e(v,{modelValue:o.apiKey,"onUpdate:modelValue":l[3]||(l[3]=t=>o.apiKey=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o.type==="custom"?(B(),R(f,{key:0,label:"Base URL"},{default:a(()=>[e(v,{modelValue:o.baseUrl,"onUpdate:modelValue":l[4]||(l[4]=t=>o.baseUrl=t),placeholder:"https://..."},null,8,["modelValue"])]),_:1})):F("",!0),e(f,{label:"启用"},{default:a(()=>[e(z,{modelValue:o.enabled,"onUpdate:modelValue":l[5]||(l[5]=t=>o.enabled=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{le as default};
