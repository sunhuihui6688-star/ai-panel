import{d as me,h as fe,c,f as r,a,w as o,k as C,l as j,g as v,r as i,o as d,e as s,F as S,j as R,t as p,i as ve,D as ce,m as ye,q as _e,E as y,L as ge}from"./index-DM4Du45G.js";import{m as V}from"./index-aDGDM6AM.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";const xe={class:"models-page"},Ve={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"16px"}},ke={style:{display:"flex","flex-wrap":"wrap",gap:"8px","margin-top":"6px","align-items":"center"}},Ce={style:{"font-size":"12px",color:"#606266"}},Ke={style:{"font-size":"12px",color:"#909399"}},Ue={style:{"font-size":"13px"}},we={style:{color:"#909399","margin-left":"4px"}},ze={class:"field-hint"},De={key:0,style:{color:"var(--el-color-primary)"}},he={key:1},$e={style:{display:"flex",gap:"8px",width:"100%","align-items":"center"}},Ie={key:0,style:{"font-size":"12px",color:"var(--el-color-danger)"}},Me={key:1,style:{"font-size":"12px",color:"var(--el-color-success)"}},Ae={key:2,style:{"font-size":"12px",color:"#909399"}},Ee=me({__name:"ModelsView",setup(Pe){const D=v([]),x=v(!1),k=v(""),M=v(!1),A=v(""),E=v(!1),f=v(""),u=v([]),P=v(""),h=v([]),K={anthropic:"https://api.anthropic.com",openai:"https://api.openai.com",deepseek:"https://api.deepseek.com",openrouter:"https://openrouter.ai/api",custom:""};function L(t){return K[t]||"â€”"}const _=ye(()=>h.value.find(t=>t.provider===n.provider)||null),n=_e({id:"",name:"",provider:"anthropic",model:"",apiKey:"",baseUrl:"https://api.anthropic.com",isDefault:!1});fe(async()=>{await Promise.all([$(),T()])});async function $(){try{const t=await V.list();D.value=t.data}catch{}}async function T(){try{const t=await V.envKeys();h.value=t.data.envKeys||[]}catch{}}function G(){n.baseUrl=K[n.provider]||"",n.model="",u.value=[],f.value="",n.provider==="openrouter"&&q()}function H(){_.value&&(n.apiKey=_.value.masked,y.info("å·²å¡«å…¥ï¼ˆæ˜¾ç¤ºä¸ºæŽ©ç ï¼Œå®žé™…ä½¿ç”¨çŽ¯å¢ƒå˜é‡å€¼ï¼‰"))}function J(t){const e=u.value.find(U=>U.id===t);e&&(n.name=e.name&&e.name!==e.id?e.name:t),n.id||(n.id=t.replace(/[^a-z0-9]/gi,"-").toLowerCase().replace(/-+/g,"-").replace(/^-|-$/g,""))}function Q(){n.name||(n.name=n.model),n.id||(n.id=n.model.replace(/[^a-z0-9]/gi,"-").toLowerCase().replace(/-+/g,"-").replace(/^-|-$/g,""))}async function q(){if(!n.baseUrl){f.value="è¯·å…ˆå¡«å†™è°ƒç”¨åœ°å€";return}E.value=!0,f.value="",u.value=[];let t=n.apiKey;(!t||t.includes("***"))&&(t="");try{const e=await V.probe(n.baseUrl,t||void 0,n.provider);u.value=e.data.models||[],u.value.length||(f.value="æœªèŽ·å–åˆ°æ¨¡åž‹åˆ—è¡¨ï¼ˆæŽ¥å£è¿”å›žä¸ºç©ºï¼‰")}catch(e){f.value=e.response?.data?.error||e.message||"èŽ·å–å¤±è´¥"}finally{E.value=!1}}async function W(t){P.value=t.envVar;try{if(D.value.find(U=>U.provider===t.provider)){y.warning(`${t.provider} å·²æœ‰é…ç½®ï¼Œè¯·ç›´æŽ¥ç¼–è¾‘`);return}k.value="",u.value=[],f.value="",Object.assign(n,{id:t.provider+"-default",name:X(t.provider)+" (env)",provider:t.provider,model:"",apiKey:t.masked,baseUrl:t.baseUrl,isDefault:D.value.length===0}),x.value=!0,t.provider==="openrouter"&&q()}finally{P.value=""}}function X(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Y(){k.value="",u.value=[],f.value="",Object.assign(n,{id:"",name:"",provider:"anthropic",model:"",apiKey:"",baseUrl:K.anthropic,isDefault:!1}),x.value=!0}function Z(t){k.value=t.id,u.value=[],f.value="",Object.assign(n,{id:t.id,name:t.name,provider:t.provider,model:t.model,apiKey:t.apiKey,baseUrl:t.baseUrl||K[t.provider]||"",isDefault:t.isDefault}),x.value=!0}async function ee(){if(!n.id||!n.provider||!n.model){y.warning("è¯·å¡«å†™å¿…è¦å­—æ®µï¼ˆå”¯ä¸€ID / æä¾›å•† / æ¨¡åž‹ IDï¼‰");return}M.value=!0;try{const t={...n};k.value?await V.update(k.value,t):await V.create({...t,status:"untested"}),y.success("ä¿å­˜æˆåŠŸ"),x.value=!1,$()}catch(t){y.error(t.response?.data?.error||"ä¿å­˜å¤±è´¥")}finally{M.value=!1}}async function le(t){A.value=t.id;try{const e=await V.test(t.id);e.data.valid?y.success("è¿žæŽ¥æˆåŠŸï¼"):y.error("è¿žæŽ¥å¤±è´¥: "+(e.data.error||"")),$()}catch{y.error("æµ‹è¯•è¯·æ±‚å¤±è´¥")}finally{A.value=""}}async function te(t){try{await ge.confirm(`ç¡®å®šåˆ é™¤æ¨¡åž‹ "${t.name}"ï¼Ÿ`,"ç¡®è®¤åˆ é™¤",{type:"warning"}),await V.delete(t.id),y.success("å·²åˆ é™¤"),$()}catch{}}return(t,e)=>{const U=i("Plus"),ae=i("el-icon"),m=i("el-button"),I=i("el-tag"),N=i("el-alert"),g=i("el-table-column"),O=i("el-text"),F=i("el-tooltip"),oe=i("el-table"),ne=i("el-card"),w=i("el-radio-button"),se=i("el-radio-group"),b=i("el-form-item"),z=i("el-input"),ie=i("el-option"),de=i("el-select"),re=i("el-switch"),ue=i("el-form"),pe=i("el-dialog");return d(),c("div",xe,[r("div",Ve,[e[13]||(e[13]=r("h2",{style:{margin:"0"}},"ðŸ¤– æ¨¡åž‹é…ç½®",-1)),a(m,{type:"primary",onClick:Y},{default:o(()=>[a(ae,null,{default:o(()=>[a(U)]),_:1}),e[12]||(e[12]=s(" æ·»åŠ æ¨¡åž‹ ",-1))]),_:1})]),h.value.length?(d(),C(N,{key:0,type:"success",closable:!1,style:{"margin-bottom":"16px"}},{title:o(()=>[...e[14]||(e[14]=[r("span",{style:{"font-weight":"600"}},"ðŸ”‘ æ£€æµ‹åˆ°ç³»ç»ŸçŽ¯å¢ƒå˜é‡ä¸­çš„ API Key",-1)])]),default:o(()=>[r("div",ke,[(d(!0),c(S,null,R(h.value,l=>(d(),c("span",{key:l.envVar,style:{display:"flex","align-items":"center",gap:"6px"}},[a(I,{type:"success",size:"small"},{default:o(()=>[s(p(l.envVar),1)]),_:2},1024),r("span",Ce,p(l.masked),1),a(m,{size:"small",type:"success",plain:"",onClick:B=>W(l),loading:P.value===l.envVar},{default:o(()=>[...e[15]||(e[15]=[s("ä¸€é”®æ·»åŠ ",-1)])]),_:1},8,["onClick","loading"])]))),128))]),e[16]||(e[16]=r("div",{style:{"font-size":"12px",color:"#909399","margin-top":"6px"}}," å·²é…ç½®çš„ Key æ— éœ€é‡å¤æ·»åŠ ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ä¸‹æ–¹å•ç‹¬é…ç½®è¦†ç›–ã€‚ ",-1))]),_:1})):j("",!0),a(ne,{shadow:"hover"},{default:o(()=>[a(oe,{data:D.value,stripe:""},{default:o(()=>[a(g,{label:"æä¾›å•†",width:"110"},{default:o(({row:l})=>[a(I,{size:"small"},{default:o(()=>[s(p(l.provider),1)]),_:2},1024)]),_:1}),a(g,{prop:"name",label:"åç§°","min-width":"130"}),a(g,{label:"æ¨¡åž‹ ID","min-width":"190"},{default:o(({row:l})=>[a(O,{type:"info",size:"small"},{default:o(()=>[s(p(l.model),1)]),_:2},1024)]),_:1}),a(g,{label:"è°ƒç”¨åœ°å€","min-width":"190"},{default:o(({row:l})=>[a(F,{content:l.baseUrl||L(l.provider),placement:"top"},{default:o(()=>[a(O,{type:"info",size:"small",truncated:"",style:{"max-width":"180px",display:"block"}},{default:o(()=>[s(p(l.baseUrl||L(l.provider)),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(g,{label:"API Key",width:"140"},{default:o(({row:l})=>[r("code",Ke,p(l.apiKey),1)]),_:1}),a(g,{label:"çŠ¶æ€",width:"90"},{default:o(({row:l})=>[a(I,{type:l.status==="ok"?"success":l.status==="error"?"danger":"info",size:"small"},{default:o(()=>[s(p(l.status==="ok"?"âœ“ æœ‰æ•ˆ":l.status==="error"?"âœ— æ— æ•ˆ":"? æœªæµ‹"),1)]),_:2},1032,["type"])]),_:1}),a(g,{label:"é»˜è®¤",width:"60"},{default:o(({row:l})=>[l.isDefault?(d(),C(I,{key:0,type:"warning",size:"small"},{default:o(()=>[...e[17]||(e[17]=[s("é»˜è®¤",-1)])]),_:1})):j("",!0)]),_:1}),a(g,{label:"æ“ä½œ",width:"180"},{default:o(({row:l})=>[a(m,{size:"small",onClick:B=>le(l),loading:A.value===l.id},{default:o(()=>[...e[18]||(e[18]=[s("æµ‹è¯•",-1)])]),_:1},8,["onClick","loading"]),a(m,{size:"small",onClick:B=>Z(l)},{default:o(()=>[...e[19]||(e[19]=[s("ç¼–è¾‘",-1)])]),_:1},8,["onClick"]),a(m,{size:"small",type:"danger",onClick:B=>te(l)},{default:o(()=>[...e[20]||(e[20]=[s("åˆ é™¤",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),a(pe,{modelValue:x.value,"onUpdate:modelValue":e[11]||(e[11]=l=>x.value=l),title:k.value?"ç¼–è¾‘æ¨¡åž‹":"æ·»åŠ æ¨¡åž‹",width:"580px","align-center":""},{footer:o(()=>[a(m,{onClick:e[10]||(e[10]=l=>x.value=!1)},{default:o(()=>[...e[31]||(e[31]=[s("å–æ¶ˆ",-1)])]),_:1}),a(m,{type:"primary",onClick:ee,loading:M.value},{default:o(()=>[...e[32]||(e[32]=[s("ä¿å­˜",-1)])]),_:1},8,["loading"])]),default:o(()=>[a(ue,{model:n,"label-width":"90px",style:{"padding-right":"8px"}},{default:o(()=>[a(b,{label:"æä¾›å•†",required:""},{default:o(()=>[a(se,{modelValue:n.provider,"onUpdate:modelValue":e[0]||(e[0]=l=>n.provider=l),onChange:G,size:"small"},{default:o(()=>[a(w,{value:"anthropic"},{default:o(()=>[...e[21]||(e[21]=[s("Anthropic",-1)])]),_:1}),a(w,{value:"openai"},{default:o(()=>[...e[22]||(e[22]=[s("OpenAI",-1)])]),_:1}),a(w,{value:"deepseek"},{default:o(()=>[...e[23]||(e[23]=[s("DeepSeek",-1)])]),_:1}),a(w,{value:"openrouter"},{default:o(()=>[...e[24]||(e[24]=[s("OpenRouter",-1)])]),_:1}),a(w,{value:"custom"},{default:o(()=>[...e[25]||(e[25]=[s("è‡ªå®šä¹‰",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(b,{label:"è°ƒç”¨åœ°å€",required:""},{default:o(()=>[a(z,{modelValue:n.baseUrl,"onUpdate:modelValue":e[2]||(e[2]=l=>n.baseUrl=l),placeholder:"https://api.anthropic.com",clearable:""},{append:o(()=>[a(F,{content:"æ¢å¤æä¾›å•†é»˜è®¤åœ°å€",placement:"top"},{default:o(()=>[a(m,{onClick:e[1]||(e[1]=l=>n.baseUrl=K[n.provider]||""),icon:ve(ce)},null,8,["icon"])]),_:1})]),_:1},8,["modelValue"]),e[26]||(e[26]=r("div",{class:"field-hint"},"ä¸­è½¬æœåŠ¡å¡«è¿™é‡Œï¼Œæ¯”å¦‚ https://your-relay.com",-1))]),_:1}),a(b,{label:"API Key"},{default:o(()=>[_.value?(d(),C(N,{key:0,type:"info",closable:!1,style:{"margin-bottom":"8px",padding:"6px 10px"}},{default:o(()=>[r("span",Ue,[e[27]||(e[27]=s(" æ£€æµ‹åˆ°ç³»ç»ŸçŽ¯å¢ƒå˜é‡ ",-1)),r("code",null,p(_.value.envVar),1),r("span",we,p(_.value.masked),1)]),a(m,{link:"",type:"primary",size:"small",style:{"margin-left":"8px"},onClick:H},{default:o(()=>[...e[28]||(e[28]=[s("ä½¿ç”¨æ­¤ Key",-1)])]),_:1}),a(m,{link:"",type:"info",size:"small",onClick:e[3]||(e[3]=l=>n.apiKey="__env__")},{default:o(()=>[...e[29]||(e[29]=[s("ç•™ç©ºï¼ˆè‡ªåŠ¨è¯»å–ï¼‰",-1)])]),_:1})]),_:1})):j("",!0),a(z,{modelValue:n.apiKey,"onUpdate:modelValue":e[4]||(e[4]=l=>n.apiKey=l),type:"password","show-password":"",placeholder:_.value?"ä¸å¡«åˆ™è‡ªåŠ¨ä½¿ç”¨çŽ¯å¢ƒå˜é‡ "+_.value.envVar:"sk-..."},null,8,["modelValue","placeholder"]),r("div",ze,[n.apiKey==="__env__"?(d(),c("span",De," âœ“ å°†è‡ªåŠ¨è¯»å– "+p(_.value?.envVar)+" çŽ¯å¢ƒå˜é‡ ",1)):(d(),c("span",he,"æ‰‹åŠ¨å¡«å†™ä¼˜å…ˆçº§é«˜äºŽçŽ¯å¢ƒå˜é‡"))])]),_:1}),a(b,{label:" ","label-width":"90px"},{default:o(()=>[r("div",$e,[a(m,{onClick:q,loading:E.value,type:"primary",plain:"",style:{"flex-shrink":"0"}},{default:o(()=>[...e[30]||(e[30]=[s(" ðŸ” èŽ·å–å¯ç”¨æ¨¡åž‹ ",-1)])]),_:1},8,["loading"]),f.value?(d(),c("span",Ie,p(f.value),1)):u.value.length?(d(),c("span",Me," âœ“ èŽ·å–åˆ° "+p(u.value.length)+" ä¸ªæ¨¡åž‹ ",1)):(d(),c("span",Ae,"å¡«å†™ Key åŽç‚¹å‡»èŽ·å–ï¼Œæˆ–ç›´æŽ¥æ‰‹åŠ¨å¡«å†™æ¨¡åž‹ ID"))])]),_:1}),a(b,{label:"æ¨¡åž‹ ID",required:""},{default:o(()=>[u.value.length?(d(),C(de,{key:0,modelValue:n.model,"onUpdate:modelValue":e[5]||(e[5]=l=>n.model=l),filterable:"",placeholder:"æœç´¢æˆ–é€‰æ‹©æ¨¡åž‹",style:{width:"100%"},onChange:J},{default:o(()=>[(d(!0),c(S,null,R(u.value,l=>(d(),C(ie,{key:l.id,label:l.name!==l.id?`${l.name}  (${l.id})`:l.id,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(d(),C(z,{key:1,modelValue:n.model,"onUpdate:modelValue":e[6]||(e[6]=l=>n.model=l),placeholder:"å¦‚ claude-sonnet-4-6ï¼ˆç‚¹ä¸Šæ–¹ã€ŒèŽ·å–å¯ç”¨æ¨¡åž‹ã€è‡ªåŠ¨åˆ—å‡ºï¼‰",onInput:Q},null,8,["modelValue"]))]),_:1}),a(b,{label:"æ˜¾ç¤ºåç§°"},{default:o(()=>[a(z,{modelValue:n.name,"onUpdate:modelValue":e[7]||(e[7]=l=>n.name=l),placeholder:"å¦‚ Claude Sonnet 4.6"},null,8,["modelValue"])]),_:1}),a(b,{label:"å”¯ä¸€ ID"},{default:o(()=>[a(z,{modelValue:n.id,"onUpdate:modelValue":e[8]||(e[8]=l=>n.id=l),placeholder:"å¦‚ claude-sonnetï¼ˆAgent å¼•ç”¨æ—¶ä½¿ç”¨ï¼‰"},null,8,["modelValue"])]),_:1}),a(b,{label:"è®¾ä¸ºé»˜è®¤"},{default:o(()=>[a(re,{modelValue:n.isDefault,"onUpdate:modelValue":e[9]||(e[9]=l=>n.isDefault=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Le=be(Ee,[["__scopeId","data-v-8756e224"]]);export{Le as default};
