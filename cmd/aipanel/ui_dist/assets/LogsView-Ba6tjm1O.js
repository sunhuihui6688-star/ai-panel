import{d as B,C as x,h as O,T as U,c as u,b as l,a as o,w as g,f as y,t as w,k as C,Q as E,H as W,g as r,x as z,O as V,r as n,o as d,F as H,l as S,q as j,j as q}from"./index-Ccgss3FR.js";import{o as D}from"./index-sb85_xT4.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"logs-page"},Q={class:"logs-header"},J={style:{margin:"0"}},K={style:{"font-size":"13px",color:"#909399","margin-top":"4px"}},P={style:{display:"flex",gap:"10px","align-items":"center"}},X={class:"log-text"},Y={key:0,class:"log-empty"},Z=B({__name:"LogsView",setup($){const p=r([]),a=r(""),_=r(!1),i=r(!0),h=r(null);let f=null;const c=z(()=>{if(!a.value)return p.value;const t=a.value.toLowerCase();return p.value.filter(e=>e.toLowerCase().includes(t))});function L(t){const e=t.toUpperCase();return e.includes("ERROR")||e.includes("[ERR]")||e.includes("FATAL")?"level-error":e.includes("WARN")||e.includes("[WARN]")||e.includes("WARNING")?"level-warn":e.includes("INFO")||e.includes("[INFO]")?"level-info":"level-default"}async function m(){_.value=!0;try{const t=await D.get(500);p.value=t.data.lines??[],i.value&&(await V(),v())}catch{}finally{_.value=!1}}function v(){const t=h.value;t&&(t.scrollTop=t.scrollHeight)}return x(i,t=>{t&&v()}),x(c,async()=>{i.value&&(await V(),v())}),O(()=>{m(),f=setInterval(m,5e3)}),U(()=>{f&&clearInterval(f)}),(t,e)=>{const k=n("List"),N=n("el-icon"),R=n("el-input"),A=n("el-switch"),I=n("el-button"),T=n("el-empty"),b=n("el-card");return d(),u("div",M,[l("div",Q,[l("div",null,[l("h2",J,[o(N,{style:{"vertical-align":"-2px","margin-right":"6px"}},{default:g(()=>[o(k)]),_:1}),e[2]||(e[2]=y("系统日志",-1))]),l("div",K," 共 "+w(c.value.length)+" 条 · 每 5 秒自动刷新 ",1)]),l("div",P,[o(R,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=s=>a.value=s),placeholder:"关键词过滤…",clearable:"",style:{width:"220px"},"prefix-icon":C(E)},null,8,["modelValue","prefix-icon"]),o(A,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=s=>i.value=s),"active-text":"自动滚动"},null,8,["modelValue"]),o(I,{onClick:m,loading:_.value,icon:C(W)},{default:g(()=>[...e[3]||(e[3]=[y("刷新",-1)])]),_:1},8,["loading","icon"])])]),o(b,{shadow:"never",class:"log-card"},{default:g(()=>[l("div",{ref_key:"logContainer",ref:h,class:"log-container"},[(d(!0),u(H,null,S(c.value,(s,F)=>(d(),u("div",{key:F,class:j(["log-line",L(s)])},[l("span",X,w(s),1)],2))),128)),c.value.length===0?(d(),u("div",Y,[o(T,{description:a.value?"无匹配日志":"暂无日志内容"},null,8,["description"])])):q("",!0)],512)]),_:1})])}}}),oe=G(Z,[["__scopeId","data-v-abf510f6"]]);export{oe as default};
