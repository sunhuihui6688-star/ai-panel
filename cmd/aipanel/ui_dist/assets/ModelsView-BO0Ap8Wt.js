import{d as pe,h as me,c as f,f as u,a,w as o,k as x,l as j,g as v,r as i,o as d,e as s,F as S,j as R,t as p,i as fe,D as ve,m as ce,q as ye,E as g,L as _e}from"./index-C5QqZS7j.js";import{m as k}from"./index-DGv0meEh.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";const be={class:"models-page"},Ve={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"16px"}},xe={style:{display:"flex","flex-wrap":"wrap",gap:"8px","margin-top":"6px","align-items":"center"}},ke={style:{"font-size":"12px",color:"#606266"}},Ue={key:1,style:{"font-size":"12px",color:"#909399"}},Ce={style:{"font-size":"13px"}},we={class:"field-hint"},ze={key:0,style:{color:"var(--el-color-success)"}},Ke={key:1},he={style:{display:"flex",gap:"8px",width:"100%","align-items":"center"}},De={key:0,style:{"font-size":"12px",color:"var(--el-color-danger)"}},Ie={key:1,style:{"font-size":"12px",color:"var(--el-color-success)"}},$e={key:2,style:{"font-size":"12px",color:"#909399"}},Ae=pe({__name:"ModelsView",setup(Me){const D=v([]),b=v(!1),U=v(""),A=v(!1),M=v(""),E=v(!1),m=v(""),r=v([]),P=v(""),I=v([]),C={anthropic:"https://api.anthropic.com",openai:"https://api.openai.com",deepseek:"https://api.deepseek.com",openrouter:"https://openrouter.ai/api",custom:""};function L(t){return C[t]||"â€”"}const V=ce(()=>I.value.find(t=>t.provider===n.provider)||null),n=ye({id:"",name:"",provider:"anthropic",model:"",apiKey:"",baseUrl:"https://api.anthropic.com",isDefault:!1});me(async()=>{await Promise.all([$(),T()])});async function $(){try{const t=await k.list();D.value=t.data}catch{}}async function T(){try{const t=await k.envKeys();I.value=t.data.envKeys||[]}catch{}}function G(){n.baseUrl=C[n.provider]||"",n.model="",r.value=[],m.value="",n.provider==="openrouter"&&q()}function H(t){const e=r.value.find(w=>w.id===t);e&&(n.name=e.name&&e.name!==e.id?e.name:t),n.id||(n.id=t.replace(/[^a-z0-9]/gi,"-").toLowerCase().replace(/-+/g,"-").replace(/^-|-$/g,""))}function J(){n.name||(n.name=n.model),n.id||(n.id=n.model.replace(/[^a-z0-9]/gi,"-").toLowerCase().replace(/-+/g,"-").replace(/^-|-$/g,""))}async function q(){if(!n.baseUrl){m.value="è¯·å…ˆå¡«å†™è°ƒç”¨åœ°å€";return}E.value=!0,m.value="",r.value=[];let t=n.apiKey;(!t||t.includes("***"))&&(t="");try{const e=await k.probe(n.baseUrl,t||void 0,n.provider);r.value=e.data.models||[],r.value.length||(m.value="æœªèŽ·å–åˆ°æ¨¡åž‹åˆ—è¡¨ï¼ˆæŽ¥å£è¿”å›žä¸ºç©ºï¼‰")}catch(e){m.value=e.response?.data?.error||e.message||"èŽ·å–å¤±è´¥"}finally{E.value=!1}}async function Q(t){P.value=t.envVar;try{if(D.value.find(w=>w.provider===t.provider)){g.warning(`${t.provider} å·²æœ‰é…ç½®ï¼Œè¯·ç›´æŽ¥ç¼–è¾‘`);return}U.value="",r.value=[],m.value="",Object.assign(n,{id:t.provider+"-default",name:W(t.provider)+" (env)",provider:t.provider,model:"",apiKey:"",baseUrl:t.baseUrl,isDefault:D.value.length===0}),b.value=!0,t.provider==="openrouter"&&q()}finally{P.value=""}}function W(t){return t.charAt(0).toUpperCase()+t.slice(1)}function X(){U.value="",r.value=[],m.value="",Object.assign(n,{id:"",name:"",provider:"anthropic",model:"",apiKey:"",baseUrl:C.anthropic,isDefault:!1}),b.value=!0}function Y(t){U.value=t.id,r.value=[],m.value="",Object.assign(n,{id:t.id,name:t.name,provider:t.provider,model:t.model,apiKey:t.apiKey,baseUrl:t.baseUrl||C[t.provider]||"",isDefault:t.isDefault}),b.value=!0}async function Z(){if(!n.id||!n.provider||!n.model){g.warning("è¯·å¡«å†™å¿…è¦å­—æ®µï¼ˆå”¯ä¸€ID / æä¾›å•† / æ¨¡åž‹ IDï¼‰");return}A.value=!0;try{const t={...n};U.value?await k.update(U.value,t):await k.create({...t,status:"untested"}),g.success("ä¿å­˜æˆåŠŸ"),b.value=!1,$()}catch(t){g.error(t.response?.data?.error||"ä¿å­˜å¤±è´¥")}finally{A.value=!1}}async function ee(t){M.value=t.id;try{const e=await k.test(t.id);e.data.valid?g.success("è¿žæŽ¥æˆåŠŸï¼"):g.error("è¿žæŽ¥å¤±è´¥: "+(e.data.error||"")),$()}catch{g.error("æµ‹è¯•è¯·æ±‚å¤±è´¥")}finally{M.value=""}}async function le(t){try{await _e.confirm(`ç¡®å®šåˆ é™¤æ¨¡åž‹ "${t.name}"ï¼Ÿ`,"ç¡®è®¤åˆ é™¤",{type:"warning"}),await k.delete(t.id),g.success("å·²åˆ é™¤"),$()}catch{}}return(t,e)=>{const w=i("Plus"),te=i("el-icon"),c=i("el-button"),z=i("el-tag"),N=i("el-alert"),y=i("el-table-column"),O=i("el-text"),F=i("el-tooltip"),ae=i("el-table"),oe=i("el-card"),K=i("el-radio-button"),ne=i("el-radio-group"),_=i("el-form-item"),h=i("el-input"),se=i("el-option"),ie=i("el-select"),de=i("el-switch"),re=i("el-form"),ue=i("el-dialog");return d(),f("div",be,[u("div",Ve,[e[12]||(e[12]=u("h2",{style:{margin:"0"}},"ðŸ¤– æ¨¡åž‹é…ç½®",-1)),a(c,{type:"primary",onClick:X},{default:o(()=>[a(te,null,{default:o(()=>[a(w)]),_:1}),e[11]||(e[11]=s(" æ·»åŠ æ¨¡åž‹ ",-1))]),_:1})]),I.value.length?(d(),x(N,{key:0,type:"success",closable:!1,style:{"margin-bottom":"16px"}},{title:o(()=>[...e[13]||(e[13]=[u("span",{style:{"font-weight":"600"}},"ðŸ”‘ æ£€æµ‹åˆ°ç³»ç»ŸçŽ¯å¢ƒå˜é‡ä¸­çš„ API Key",-1)])]),default:o(()=>[u("div",xe,[(d(!0),f(S,null,R(I.value,l=>(d(),f("span",{key:l.envVar,style:{display:"flex","align-items":"center",gap:"6px"}},[a(z,{type:"success",size:"small"},{default:o(()=>[s(p(l.envVar),1)]),_:2},1024),u("span",ke,p(l.masked),1),a(c,{size:"small",type:"success",plain:"",onClick:B=>Q(l),loading:P.value===l.envVar},{default:o(()=>[...e[14]||(e[14]=[s("ä¸€é”®æ·»åŠ ",-1)])]),_:1},8,["onClick","loading"])]))),128))]),e[15]||(e[15]=u("div",{style:{"font-size":"12px",color:"#909399","margin-top":"6px"}}," å·²é…ç½®çš„ Key æ— éœ€é‡å¤æ·»åŠ ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ä¸‹æ–¹å•ç‹¬é…ç½®è¦†ç›–ã€‚ ",-1))]),_:1})):j("",!0),a(oe,{shadow:"hover"},{default:o(()=>[a(ae,{data:D.value,stripe:""},{default:o(()=>[a(y,{label:"æä¾›å•†",width:"110"},{default:o(({row:l})=>[a(z,{size:"small"},{default:o(()=>[s(p(l.provider),1)]),_:2},1024)]),_:1}),a(y,{prop:"name",label:"åç§°","min-width":"130"}),a(y,{label:"æ¨¡åž‹ ID","min-width":"190"},{default:o(({row:l})=>[a(O,{type:"info",size:"small"},{default:o(()=>[s(p(l.model),1)]),_:2},1024)]),_:1}),a(y,{label:"è°ƒç”¨åœ°å€","min-width":"190"},{default:o(({row:l})=>[a(F,{content:l.baseUrl||L(l.provider),placement:"top"},{default:o(()=>[a(O,{type:"info",size:"small",truncated:"",style:{"max-width":"180px",display:"block"}},{default:o(()=>[s(p(l.baseUrl||L(l.provider)),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(y,{label:"API Key",width:"160"},{default:o(({row:l})=>[l.apiKey?(d(),f("code",Ue,p(l.apiKey),1)):(d(),x(z,{key:0,type:"info",size:"small",style:{"font-size":"11px"}},{default:o(()=>[...e[16]||(e[16]=[s(" ðŸŒ ä½¿ç”¨çŽ¯å¢ƒå˜é‡ ",-1)])]),_:1}))]),_:1}),a(y,{label:"çŠ¶æ€",width:"90"},{default:o(({row:l})=>[a(z,{type:l.status==="ok"?"success":l.status==="error"?"danger":"info",size:"small"},{default:o(()=>[s(p(l.status==="ok"?"âœ“ æœ‰æ•ˆ":l.status==="error"?"âœ— æ— æ•ˆ":"? æœªæµ‹"),1)]),_:2},1032,["type"])]),_:1}),a(y,{label:"é»˜è®¤",width:"60"},{default:o(({row:l})=>[l.isDefault?(d(),x(z,{key:0,type:"warning",size:"small"},{default:o(()=>[...e[17]||(e[17]=[s("é»˜è®¤",-1)])]),_:1})):j("",!0)]),_:1}),a(y,{label:"æ“ä½œ",width:"180"},{default:o(({row:l})=>[a(c,{size:"small",onClick:B=>ee(l),loading:M.value===l.id},{default:o(()=>[...e[18]||(e[18]=[s("æµ‹è¯•",-1)])]),_:1},8,["onClick","loading"]),a(c,{size:"small",onClick:B=>Y(l)},{default:o(()=>[...e[19]||(e[19]=[s("ç¼–è¾‘",-1)])]),_:1},8,["onClick"]),a(c,{size:"small",type:"danger",onClick:B=>le(l)},{default:o(()=>[...e[20]||(e[20]=[s("åˆ é™¤",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),a(ue,{modelValue:b.value,"onUpdate:modelValue":e[10]||(e[10]=l=>b.value=l),title:U.value?"ç¼–è¾‘æ¨¡åž‹":"æ·»åŠ æ¨¡åž‹",width:"580px","align-center":""},{footer:o(()=>[a(c,{onClick:e[9]||(e[9]=l=>b.value=!1)},{default:o(()=>[...e[30]||(e[30]=[s("å–æ¶ˆ",-1)])]),_:1}),a(c,{type:"primary",onClick:Z,loading:A.value},{default:o(()=>[...e[31]||(e[31]=[s("ä¿å­˜",-1)])]),_:1},8,["loading"])]),default:o(()=>[a(re,{model:n,"label-width":"90px",style:{"padding-right":"8px"}},{default:o(()=>[a(_,{label:"æä¾›å•†",required:""},{default:o(()=>[a(ne,{modelValue:n.provider,"onUpdate:modelValue":e[0]||(e[0]=l=>n.provider=l),onChange:G,size:"small"},{default:o(()=>[a(K,{value:"anthropic"},{default:o(()=>[...e[21]||(e[21]=[s("Anthropic",-1)])]),_:1}),a(K,{value:"openai"},{default:o(()=>[...e[22]||(e[22]=[s("OpenAI",-1)])]),_:1}),a(K,{value:"deepseek"},{default:o(()=>[...e[23]||(e[23]=[s("DeepSeek",-1)])]),_:1}),a(K,{value:"openrouter"},{default:o(()=>[...e[24]||(e[24]=[s("OpenRouter",-1)])]),_:1}),a(K,{value:"custom"},{default:o(()=>[...e[25]||(e[25]=[s("è‡ªå®šä¹‰",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(_,{label:"è°ƒç”¨åœ°å€",required:""},{default:o(()=>[a(h,{modelValue:n.baseUrl,"onUpdate:modelValue":e[2]||(e[2]=l=>n.baseUrl=l),placeholder:"https://api.anthropic.com",clearable:""},{append:o(()=>[a(F,{content:"æ¢å¤æä¾›å•†é»˜è®¤åœ°å€",placement:"top"},{default:o(()=>[a(c,{onClick:e[1]||(e[1]=l=>n.baseUrl=C[n.provider]||""),icon:fe(ve)},null,8,["icon"])]),_:1})]),_:1},8,["modelValue"]),e[26]||(e[26]=u("div",{class:"field-hint"},"ä¸­è½¬æœåŠ¡å¡«è¿™é‡Œï¼Œæ¯”å¦‚ https://your-relay.com",-1))]),_:1}),a(_,{label:"API Key"},{default:o(()=>[V.value?(d(),x(N,{key:0,type:"success",closable:!1,style:{"margin-bottom":"8px",padding:"6px 12px"}},{default:o(()=>[u("span",Ce,[e[27]||(e[27]=s(" âœ… æ£€æµ‹åˆ° ",-1)),u("code",null,p(V.value.envVar),1),s("ï¼ˆ"+p(V.value.masked)+"ï¼‰ â€” ",1),e[28]||(e[28]=u("strong",null,"ä¸å¡« API Key å³å¯è‡ªåŠ¨ä½¿ç”¨",-1))])]),_:1})):j("",!0),a(h,{modelValue:n.apiKey,"onUpdate:modelValue":e[3]||(e[3]=l=>n.apiKey=l),type:"password","show-password":"",placeholder:V.value?"ç•™ç©º = è‡ªåŠ¨è¯»å– "+V.value.envVar:"sk-..."},null,8,["modelValue","placeholder"]),u("div",we,[!n.apiKey&&V.value?(d(),f("span",ze," âœ“ ç•™ç©ºåŽå°†è‡ªåŠ¨ä½¿ç”¨ "+p(V.value.envVar)+" çŽ¯å¢ƒå˜é‡ ",1)):(d(),f("span",Ke,"æ‰‹åŠ¨å¡«å†™ä¼˜å…ˆçº§é«˜äºŽçŽ¯å¢ƒå˜é‡"))])]),_:1}),a(_,{label:" ","label-width":"90px"},{default:o(()=>[u("div",he,[a(c,{onClick:q,loading:E.value,type:"primary",plain:"",style:{"flex-shrink":"0"}},{default:o(()=>[...e[29]||(e[29]=[s(" ðŸ” èŽ·å–å¯ç”¨æ¨¡åž‹ ",-1)])]),_:1},8,["loading"]),m.value?(d(),f("span",De,p(m.value),1)):r.value.length?(d(),f("span",Ie," âœ“ èŽ·å–åˆ° "+p(r.value.length)+" ä¸ªæ¨¡åž‹ ",1)):(d(),f("span",$e,"å¡«å†™ Key åŽç‚¹å‡»èŽ·å–ï¼Œæˆ–ç›´æŽ¥æ‰‹åŠ¨å¡«å†™æ¨¡åž‹ ID"))])]),_:1}),a(_,{label:"æ¨¡åž‹ ID",required:""},{default:o(()=>[r.value.length?(d(),x(ie,{key:0,modelValue:n.model,"onUpdate:modelValue":e[4]||(e[4]=l=>n.model=l),filterable:"",placeholder:"æœç´¢æˆ–é€‰æ‹©æ¨¡åž‹",style:{width:"100%"},onChange:H},{default:o(()=>[(d(!0),f(S,null,R(r.value,l=>(d(),x(se,{key:l.id,label:l.name!==l.id?`${l.name}  (${l.id})`:l.id,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(d(),x(h,{key:1,modelValue:n.model,"onUpdate:modelValue":e[5]||(e[5]=l=>n.model=l),placeholder:"å¦‚ claude-sonnet-4-6ï¼ˆç‚¹ä¸Šæ–¹ã€ŒèŽ·å–å¯ç”¨æ¨¡åž‹ã€è‡ªåŠ¨åˆ—å‡ºï¼‰",onInput:J},null,8,["modelValue"]))]),_:1}),a(_,{label:"æ˜¾ç¤ºåç§°"},{default:o(()=>[a(h,{modelValue:n.name,"onUpdate:modelValue":e[6]||(e[6]=l=>n.name=l),placeholder:"å¦‚ Claude Sonnet 4.6"},null,8,["modelValue"])]),_:1}),a(_,{label:"å”¯ä¸€ ID"},{default:o(()=>[a(h,{modelValue:n.id,"onUpdate:modelValue":e[7]||(e[7]=l=>n.id=l),placeholder:"å¦‚ claude-sonnetï¼ˆAgent å¼•ç”¨æ—¶ä½¿ç”¨ï¼‰"},null,8,["modelValue"])]),_:1}),a(_,{label:"è®¾ä¸ºé»˜è®¤"},{default:o(()=>[a(de,{modelValue:n.isDefault,"onUpdate:modelValue":e[8]||(e[8]=l=>n.isDefault=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Be=ge(Ae,[["__scopeId","data-v-42808319"]]);export{Be as default};
