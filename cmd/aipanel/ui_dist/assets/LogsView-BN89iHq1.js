import{d as F,B as x,h as U,T as E,c as u,b as l,a as o,w as g,f as y,t as w,k as V,P as O,I as W,g as r,x as z,D as C,r as n,o as d,F as D,l as S,q as j,j as q}from"./index-ChTFaCUg.js";import{o as G}from"./index-B6ZRKErS.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"logs-page"},P={class:"logs-header"},J={style:{margin:"0"}},K={style:{"font-size":"13px",color:"#909399","margin-top":"4px"}},Q={style:{display:"flex",gap:"10px","align-items":"center"}},X={class:"log-text"},Y={key:0,class:"log-empty"},Z=F({__name:"LogsView",setup($){const p=r([]),a=r(""),_=r(!1),i=r(!0),h=r(null);let f=null;const c=z(()=>{if(!a.value)return p.value;const t=a.value.toLowerCase();return p.value.filter(e=>e.toLowerCase().includes(t))});function L(t){const e=t.toUpperCase();return e.includes("ERROR")||e.includes("[ERR]")||e.includes("FATAL")?"level-error":e.includes("WARN")||e.includes("[WARN]")||e.includes("WARNING")?"level-warn":e.includes("INFO")||e.includes("[INFO]")?"level-info":"level-default"}async function m(){_.value=!0;try{const t=await G.get(500);p.value=t.data.lines??[],i.value&&(await C(),v())}catch{}finally{_.value=!1}}function v(){const t=h.value;t&&(t.scrollTop=t.scrollHeight)}return x(i,t=>{t&&v()}),x(c,async()=>{i.value&&(await C(),v())}),U(()=>{m(),f=setInterval(m,5e3)}),E(()=>{f&&clearInterval(f)}),(t,e)=>{const k=n("List"),N=n("el-icon"),R=n("el-input"),I=n("el-switch"),A=n("el-button"),T=n("el-empty"),b=n("el-card");return d(),u("div",M,[l("div",P,[l("div",null,[l("h2",J,[o(N,{style:{"vertical-align":"-2px","margin-right":"6px"}},{default:g(()=>[o(k)]),_:1}),e[2]||(e[2]=y("系统日志",-1))]),l("div",K," 共 "+w(c.value.length)+" 条 · 每 5 秒自动刷新 ",1)]),l("div",Q,[o(R,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=s=>a.value=s),placeholder:"关键词过滤…",clearable:"",style:{width:"220px"},"prefix-icon":V(O)},null,8,["modelValue","prefix-icon"]),o(I,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=s=>i.value=s),"active-text":"自动滚动"},null,8,["modelValue"]),o(A,{onClick:m,loading:_.value,icon:V(W)},{default:g(()=>[...e[3]||(e[3]=[y("刷新",-1)])]),_:1},8,["loading","icon"])])]),o(b,{shadow:"never",class:"log-card"},{default:g(()=>[l("div",{ref_key:"logContainer",ref:h,class:"log-container"},[(d(!0),u(D,null,S(c.value,(s,B)=>(d(),u("div",{key:B,class:j(["log-line",L(s)])},[l("span",X,w(s),1)],2))),128)),c.value.length===0?(d(),u("div",Y,[o(T,{description:a.value?"无匹配日志":"暂无日志内容"},null,8,["description"])])):q("",!0)],512)]),_:1})])}}}),oe=H(Z,[["__scopeId","data-v-abf510f6"]]);export{oe as default};
