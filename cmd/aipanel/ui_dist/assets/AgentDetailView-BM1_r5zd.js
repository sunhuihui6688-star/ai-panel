import{d as gt,h as _t,E as f,i as _,w as l,B as bt,g as i,r as m,o as d,a as t,f as u,k as z,y as ht,t as r,e as s,z as _e,m as wt,c as b,F as N,l as Q,q as xt,j as U,n as be,C as kt,D as Vt,G as Ct,H as zt,I as At}from"./index-B6HcBUbG.js";import{b as he,f as X,e as Z,g as ee,h as Tt,r as Me}from"./index-C3p5gGNP.js";import{A as $t}from"./AiChat-yqnxVKq-.js";import{_ as It}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ut={class:"header-left"},Ft={class:"chat-layout"},St={class:"session-sidebar"},Nt={class:"session-sidebar-header"},Dt={class:"session-list"},Mt=["onClick"],Et={class:"session-item-title"},Bt={class:"session-item-meta"},Rt={key:0,class:"session-empty"},Lt={class:"at-panel"},jt={key:0,class:"at-form"},Pt={class:"chat-area"},Yt={style:{display:"flex","align-items":"center",gap:"8px"}},Ot={style:{"font-weight":"600"}},qt={key:0,style:{"text-align":"center",color:"#c0c4cc",padding:"32px 0","font-size":"14px"}},Gt={style:{display:"flex","align-items":"center",gap:"8px"}},Ht={style:{"font-size":"13px"}},Jt={style:{"font-size":"13px",color:"#606266"}},Kt={key:0,style:{"text-align":"center",color:"#c0c4cc",padding:"40px 0"}},Wt={key:1,class:"relations-list"},Qt={class:"relation-info"},Xt={class:"relation-name"},Zt={class:"relation-tags"},el={class:"relation-desc"},tl={class:"memory-toolbar",style:{"margin-bottom":"12px",display:"flex",gap:"8px"}},ll={style:{display:"flex","align-items":"center",gap:"4px","font-size":"13px"}},al={style:{display:"flex","align-items":"center","justify-content":"space-between"}},nl={style:{"margin-top":"8px",display:"flex",gap:"8px","align-items":"center"}},sl=gt({__name:"AgentDetailView",setup(ol){const we=bt(),p=we.params.id,D=i(null),xe=i("chat"),A=i(),te=i([]),le=i(!1),M=i();async function ke(){le.value=!0;try{const n=await Tt.list({agentId:p,limit:50});te.value=n.data.sessions}catch{}finally{le.value=!1}}function Ee(n){M.value=n.id,A.value?.resumeSession(n.id)}function Be(){M.value=void 0,A.value?.startNewSession()}function Re(n){M.value=n,setTimeout(ke,500)}function Le(n){if(!n)return"";const e=Date.now()-n;return e<6e4?"刚刚":e<36e5?`${Math.floor(e/6e4)}分前`:e<864e5?`${Math.floor(e/36e5)}小时前`:`${Math.floor(e/864e5)}天前`}const Y=i(!1),O=i(""),q=i(""),re=i(!1),T=i([]);function je(){Y.value=!Y.value,Y.value&&!T.value.length&&Ve()}async function Ve(){try{const n=await he.list();T.value=n.data.filter(e=>e.id!==p)}catch{T.value=[]}}function Pe(n){const e=T.value.find(o=>o.id===n);e&&A.value?.fillInput(`@${e.name}: `)}async function Ye(){const n=O.value,e=q.value.trim();if(!n||!e)return;const y=T.value.find(F=>F.id===n)?.name??n;re.value=!0;const $={role:"user",text:`→ 转发给 ${y}：
${e}`};A.value?.appendMessage($);try{const g=(await he.message(n,e,p)).data.response,S={role:"assistant",text:`← **${y}** 回复：

${g}`};A.value?.appendMessage(S),q.value="",O.value="",Y.value=!1,f.success(`${y} 已回复`)}catch(F){const g={role:"system",text:`❌ 转发失败：${F.response?.data?.error??F.message??"网络错误"}`};A.value?.appendMessage(g),f.error("转发失败")}finally{re.value=!1}}const ae=i(""),ne=i(""),se=i([]),E=i(""),B=i(""),me=i(!1),fe=i([]),G=i(!1),oe=i(""),H=i(!1),ie=i(""),Ce=i([]),R=i(""),J=i(""),ue=i(null),w=i([]),pe=i(!1),c=i({agentId:"",agentName:"",relationType:"平级协作",strength:"常用",desc:""});async function Oe(){try{const n=await Me.get(p);w.value=n.data.parsed||[]}catch{w.value=[]}}function qe(n){const e=T.value.find(o=>o.id===n);c.value.agentName=e?e.name:n}async function Ge(){if(!c.value.agentId)return;if(w.value.find(e=>e.agentId===c.value.agentId)){f.warning("该成员关系已存在，请先删除再重新添加");return}w.value.push({...c.value}),c.value={agentId:"",agentName:"",relationType:"平级协作",strength:"常用",desc:""},await ze()}async function He(n){w.value.splice(n,1),await ze()}function Je(){return w.value.map(n=>`${n.agentId} | ${n.agentName} | ${n.relationType} | ${n.strength} | ${n.desc||""}`).join(`
`)}async function ze(){pe.value=!0;try{await Me.put(p,Je()),f.success("关系已保存")}catch{f.error("保存失败")}finally{pe.value=!1}}function ce(n){const e=["#409EFF","#67C23A","#E6A23C","#F56C6C","#909399","#B45309","#7C3AED","#0891B2"];let o=0;for(let y=0;y<n.length;y++)o=n.charCodeAt(y)+((o<<5)-o);return e[Math.abs(o)%e.length]??"#409EFF"}function Ae(n){return n==="上级"?"danger":n==="下级"?"":n==="平级协作"?"success":"info"}function Te(n){return n==="核心"?"danger":n==="常用"?"warning":"info"}const $e=i([]),K=i(!1),v=i({name:"",expr:"0 9 * * *",tz:"Asia/Shanghai",message:"",enabled:!0});function Ke(n){return n==="running"?"success":n==="stopped"?"danger":"info"}function We(n){return n==="running"?"运行中":n==="stopped"?"已停止":"空闲"}function Ie(n){return n?n<1024?n+" B":n<1048576?(n/1024).toFixed(1)+" KB":(n/1048576).toFixed(1)+" MB":"0 B"}function Qe(n){return new Date(n).toLocaleString()}function Xe(n){return n?new Date(n).toLocaleString():""}_t(async()=>{try{const e=await he.get(p);D.value=e.data}catch{f.error("加载 Agent 失败")}Ze(),Oe(),Ve(),nt(),de(),await ke();const n=we.query.resumeSession;n&&(M.value=n,await new Promise(o=>setTimeout(o,100)),A.value?.resumeSession(n),te.value.find(o=>o.id===n)||(M.value=n))});async function Ze(){try{const[n,e]=await Promise.all([X.read(p,"IDENTITY.md"),X.read(p,"SOUL.md")]);ae.value=n.data?.content||"",ne.value=e.data?.content||""}catch{}W()}async function ve(n,e){try{await X.write(p,n,e),f.success(`${n} 已保存`)}catch{f.error(`保存 ${n} 失败`)}}async function W(){try{const n=await Z.tree(p);se.value=n.data||[]}catch{se.value=[]}}async function et(n){if(!n.isDir){E.value=n.path,fe.value=n.path.split("/");try{const e=await Z.readFile(p,n.path);B.value=e.data?.content||""}catch{B.value="(无法读取)"}}}async function tt(){if(E.value){me.value=!0;try{await Z.writeFile(p,E.value,B.value),f.success("记忆文件已保存"),W()}catch{f.error("保存失败")}finally{me.value=!1}}}async function lt(){const n=oe.value.trim();if(!n){f.warning("请输入路径");return}try{await Z.writeFile(p,n,`# ${n.split("/").pop()?.replace(".md","")||"New File"}

`),f.success("文件已创建"),G.value=!1,oe.value="",W(),E.value=n,fe.value=n.split("/"),B.value=`# ${n.split("/").pop()?.replace(".md","")||"New File"}

`}catch{f.error("创建失败")}}async function at(){const n=ie.value.trim();if(!n){f.warning("请输入内容");return}try{await Z.dailyLog(p,n),f.success("日志已添加"),H.value=!1,ie.value="",W()}catch{f.error("添加失败")}}async function nt(){try{const n=await X.read(p,"/");Array.isArray(n.data)&&(Ce.value=n.data.map(e=>({name:e.name,isDir:e.isDir,size:e.size,modTime:e.modTime,path:e.name})))}catch{}}async function st(n){if(!n.isDir){R.value=n.path||n.name,ue.value=n;try{const e=await X.read(p,R.value);J.value=e.data?.content||""}catch{J.value="(无法读取)"}}}async function ot(){R.value&&await ve(R.value,J.value)}async function de(){try{const n=await ee.list();$e.value=n.data||[]}catch{}}async function it(){try{await ee.create({name:v.value.name,enabled:v.value.enabled,schedule:{kind:"cron",expr:v.value.expr,tz:v.value.tz},payload:{kind:"agentTurn",message:v.value.message},delivery:{mode:"announce"}}),f.success("任务创建成功"),K.value=!1,de()}catch(n){f.error(n.response?.data?.error||"创建失败")}}async function ut(n){try{await ee.update(n.id,n)}catch{f.error("更新失败")}}async function dt(n){try{await ee.run(n.id),f.success("已触发运行"),setTimeout(de,2e3)}catch{f.error("运行失败")}}async function rt(n){try{await ee.delete(n.id),f.success("已删除"),de()}catch{f.error("删除失败")}}return(n,e)=>{const o=m("el-button"),y=m("el-tag"),$=m("el-text"),F=m("el-header"),g=m("el-option"),S=m("el-select"),x=m("el-input"),L=m("el-tab-pane"),C=m("el-card"),h=m("el-col"),j=m("el-row"),k=m("el-form-item"),ye=m("el-form"),mt=m("el-badge"),V=m("el-table-column"),Ue=m("el-table"),P=m("el-icon"),Fe=m("el-tree"),Se=m("el-empty"),Ne=m("el-breadcrumb-item"),ft=m("el-breadcrumb"),ge=m("el-dialog"),De=m("el-switch"),pt=m("el-tabs"),ct=m("el-main"),vt=m("el-container"),yt=At("loading");return d(),_(vt,{class:"agent-detail"},{default:l(()=>[t(F,{class:"detail-header"},{default:l(()=>[u("div",Ut,[t(o,{icon:z(ht),onClick:e[0]||(e[0]=a=>n.$router.push("/agents")),circle:""},null,8,["icon"]),u("h2",null,r(D.value?.name||"..."),1),t(y,{type:Ke(D.value?.status)},{default:l(()=>[s(r(We(D.value?.status)),1)]),_:1},8,["type"])]),t($,{type:"info"},{default:l(()=>[s(r(D.value?.model),1)]),_:1})]),_:1}),t(ct,null,{default:l(()=>[t(pt,{modelValue:xe.value,"onUpdate:modelValue":e[29]||(e[29]=a=>xe.value=a),type:"border-card"},{default:l(()=>[t(L,{label:"对话",name:"chat"},{default:l(()=>[u("div",Ft,[u("div",St,[u("div",Nt,[e[31]||(e[31]=u("span",{class:"sidebar-title"},"历史对话",-1)),t(o,{size:"small",type:"primary",plain:"",onClick:Be,icon:z(_e)},{default:l(()=>[...e[30]||(e[30]=[s("新建",-1)])]),_:1},8,["icon"])]),wt((d(),b("div",Dt,[(d(!0),b(N,null,Q(te.value,a=>(d(),b("div",{key:a.id,class:xt(["session-item",{active:M.value===a.id}]),onClick:I=>Ee(a)},[u("div",Et,r(a.title||"新对话"),1),u("div",Bt,[u("span",null,r(Le(a.lastAt)),1),t(y,{size:"small",type:"info",effect:"plain",style:{"font-size":"10px",padding:"0 4px"}},{default:l(()=>[s(r(a.messageCount)+" 条 ",1)]),_:2},1024),a.tokenEstimate>6e4?(d(),_(y,{key:0,size:"small",type:"warning",effect:"plain",style:{"font-size":"10px",padding:"0 4px"}},{default:l(()=>[s("~"+r(Math.round(a.tokenEstimate/1e3))+"k",1)]),_:2},1024)):U("",!0)])],10,Mt))),128)),!le.value&&!te.value.length?(d(),b("div",Rt," 还没有对话记录 ")):U("",!0)])),[[yt,le.value]]),u("div",Lt,[t(o,{size:"small",plain:"",class:"at-toggle-btn",onClick:je},{default:l(()=>[...e[32]||(e[32]=[u("span",{class:"at-icon"},"@",-1),s(" 其他成员 ",-1)])]),_:1}),Y.value?(d(),b("div",jt,[t(S,{modelValue:O.value,"onUpdate:modelValue":e[1]||(e[1]=a=>O.value=a),placeholder:"选择成员",size:"small",style:{width:"100%","margin-bottom":"6px"},onChange:Pe},{default:l(()=>[(d(!0),b(N,null,Q(T.value,a=>(d(),_(g,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(x,{modelValue:q.value,"onUpdate:modelValue":e[2]||(e[2]=a=>q.value=a),type:"textarea",rows:3,placeholder:"输入要转发的消息…",size:"small",style:{"margin-bottom":"6px"}},null,8,["modelValue"]),t(o,{type:"primary",size:"small",style:{width:"100%"},loading:re.value,disabled:!O.value||!q.value.trim(),onClick:Ye},{default:l(()=>[...e[33]||(e[33]=[s(" 转发 ",-1)])]),_:1},8,["loading","disabled"])])):U("",!0)])]),u("div",Pt,[t($t,{ref_key:"aiChatRef",ref:A,"agent-id":z(p),scenario:"agent-detail","welcome-message":`你好！我是 **${D.value?.name||"AI"}**，有什么可以帮你的？`,height:"calc(100vh - 145px)","show-thinking":!0,onSessionChange:Re},null,8,["agent-id","welcome-message"])])])]),_:1}),t(L,{label:"身份 & 灵魂",name:"identity"},{default:l(()=>[t(j,{gutter:20},{default:l(()=>[t(h,{span:12},{default:l(()=>[t(C,{header:"IDENTITY.md"},{default:l(()=>[t(x,{modelValue:ae.value,"onUpdate:modelValue":e[3]||(e[3]=a=>ae.value=a),type:"textarea",rows:15,onBlur:e[4]||(e[4]=a=>ve("IDENTITY.md",ae.value))},null,8,["modelValue"])]),_:1})]),_:1}),t(h,{span:12},{default:l(()=>[t(C,{header:"SOUL.md"},{default:l(()=>[t(x,{modelValue:ne.value,"onUpdate:modelValue":e[5]||(e[5]=a=>ne.value=a),type:"textarea",rows:15,onBlur:e[6]||(e[6]=a=>ve("SOUL.md",ne.value))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(L,{label:"关系",name:"relations"},{default:l(()=>[t(j,{gutter:20},{default:l(()=>[t(h,{span:14},{default:l(()=>[t(C,{style:{"margin-bottom":"16px"}},{header:l(()=>[...e[34]||(e[34]=[u("span",{style:{"font-weight":"600"}},"添加关系",-1)])]),default:l(()=>[t(ye,{model:c.value,"label-position":"top",size:"default"},{default:l(()=>[t(j,{gutter:12},{default:l(()=>[t(h,{span:10},{default:l(()=>[t(k,{label:"关联成员"},{default:l(()=>[t(S,{modelValue:c.value.agentId,"onUpdate:modelValue":e[7]||(e[7]=a=>c.value.agentId=a),placeholder:"选择系统成员",filterable:"",style:{width:"100%"},onChange:qe},{default:l(()=>[(d(!0),b(N,null,Q(T.value,a=>(d(),_(g,{key:a.id,label:a.name,value:a.id},{default:l(()=>[u("div",Yt,[u("div",{style:be([{width:"24px",height:"24px","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center","font-size":"11px",color:"#fff","flex-shrink":"0"},{background:ce(a.id)}])},r(a.name.charAt(0)),5),u("span",null,r(a.name),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(h,{span:7},{default:l(()=>[t(k,{label:"关系类型"},{default:l(()=>[t(S,{modelValue:c.value.relationType,"onUpdate:modelValue":e[8]||(e[8]=a=>c.value.relationType=a),style:{width:"100%"}},{default:l(()=>[t(g,{label:"上级",value:"上级"}),t(g,{label:"下级",value:"下级"}),t(g,{label:"平级协作",value:"平级协作"}),t(g,{label:"支持",value:"支持"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(h,{span:7},{default:l(()=>[t(k,{label:"协作程度"},{default:l(()=>[t(S,{modelValue:c.value.strength,"onUpdate:modelValue":e[9]||(e[9]=a=>c.value.strength=a),style:{width:"100%"}},{default:l(()=>[t(g,{label:"核心",value:"核心"}),t(g,{label:"常用",value:"常用"}),t(g,{label:"偶尔",value:"偶尔"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(j,{gutter:12},{default:l(()=>[t(h,{span:18},{default:l(()=>[t(k,{label:"说明（选填）"},{default:l(()=>[t(x,{modelValue:c.value.desc,"onUpdate:modelValue":e[10]||(e[10]=a=>c.value.desc=a),placeholder:"简要描述这段关系..."},null,8,["modelValue"])]),_:1})]),_:1}),t(h,{span:6},{default:l(()=>[t(k,{label:" "},{default:l(()=>[t(o,{type:"primary",style:{width:"100%"},disabled:!c.value.agentId||!c.value.relationType||!c.value.strength,loading:pe.value,onClick:Ge},{default:l(()=>[...e[35]||(e[35]=[s(" 添加 ",-1)])]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(C,null,{header:l(()=>[u("span",Ot,[e[36]||(e[36]=s("已有关系 ",-1)),t(mt,{value:w.value.length,type:"info",style:{"margin-left":"4px"}},null,8,["value"])])]),default:l(()=>[w.value.length===0?(d(),b("div",qt," 暂无关系，请在上方添加 ")):(d(),_(Ue,{key:1,data:w.value,size:"small",style:{width:"100%"}},{default:l(()=>[t(V,{label:"成员","min-width":"120"},{default:l(({row:a})=>[u("div",Gt,[u("div",{style:be([{width:"28px",height:"28px","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center","font-size":"12px",color:"#fff","flex-shrink":"0"},{background:ce(a.agentId)}])},r(a.agentName.charAt(0)),5),u("span",Ht,r(a.agentName),1)])]),_:1}),t(V,{label:"类型",width:"100"},{default:l(({row:a})=>[t(y,{type:Ae(a.relationType),size:"small"},{default:l(()=>[s(r(a.relationType),1)]),_:2},1032,["type"])]),_:1}),t(V,{label:"程度",width:"80"},{default:l(({row:a})=>[t(y,{type:Te(a.strength),size:"small",effect:"plain"},{default:l(()=>[s(r(a.strength),1)]),_:2},1032,["type"])]),_:1}),t(V,{label:"说明","min-width":"120","show-overflow-tooltip":""},{default:l(({row:a})=>[u("span",Jt,r(a.desc||"—"),1)]),_:1}),t(V,{label:"操作",width:"70",fixed:"right"},{default:l(({$index:a})=>[t(o,{type:"danger",link:"",size:"small",onClick:I=>He(a)},{default:l(()=>[...e[37]||(e[37]=[s("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]))]),_:1})]),_:1}),t(h,{span:10},{default:l(()=>[t(C,{header:"关系预览"},{default:l(()=>[w.value.length===0?(d(),b("div",Kt," 暂无关系数据 ")):(d(),b("div",Wt,[(d(!0),b(N,null,Q(w.value,a=>(d(),b("div",{key:a.agentId,class:"relation-card"},[u("div",{class:"relation-avatar",style:be({background:ce(a.agentId)})},r(a.agentName.charAt(0).toUpperCase()),5),u("div",Qt,[u("div",Xt,r(a.agentName),1),u("div",Zt,[t(y,{type:Ae(a.relationType),size:"small"},{default:l(()=>[s(r(a.relationType),1)]),_:2},1032,["type"]),t(y,{type:Te(a.strength),size:"small",effect:"plain"},{default:l(()=>[s(r(a.strength),1)]),_:2},1032,["type"])]),u("div",el,r(a.desc),1)])]))),128))]))]),_:1})]),_:1})]),_:1})]),_:1}),t(L,{label:"记忆",name:"memory"},{default:l(()=>[u("div",tl,[t(o,{type:"primary",size:"small",onClick:e[11]||(e[11]=a=>G.value=!0)},{default:l(()=>[t(P,null,{default:l(()=>[t(z(_e))]),_:1}),e[38]||(e[38]=s(" 新建文件 ",-1))]),_:1}),t(o,{size:"small",onClick:e[12]||(e[12]=a=>H.value=!0)},{default:l(()=>[t(P,null,{default:l(()=>[t(z(kt))]),_:1}),e[39]||(e[39]=s(" 添加日志 ",-1))]),_:1}),t(o,{size:"small",onClick:W},{default:l(()=>[t(P,null,{default:l(()=>[t(z(Vt))]),_:1}),e[40]||(e[40]=s(" 刷新 ",-1))]),_:1})]),t(j,{gutter:16},{default:l(()=>[t(h,{span:7},{default:l(()=>[t(C,{header:"记忆目录",shadow:"hover"},{default:l(()=>[t(Fe,{data:se.value,props:{label:"name",children:"children",isLeaf:a=>!a.isDir},onNodeClick:et,"highlight-current":"","default-expand-all":"","expand-on-click-node":!1},{default:l(({data:a})=>[u("span",ll,[a.isDir?(d(),_(P,{key:0,style:{color:"#E6A23C"}},{default:l(()=>[t(z(Ct))]),_:1})):(d(),_(P,{key:1,style:{color:"#409EFF"}},{default:l(()=>[t(z(zt))]),_:1})),u("span",null,r(a.name),1),!a.isDir&&a.size?(d(),_($,{key:2,type:"info",size:"small",style:{"margin-left":"auto"}},{default:l(()=>[s(r(Ie(a.size)),1)]),_:2},1024)):U("",!0)])]),_:1},8,["data","props"]),se.value.length===0?(d(),_(Se,{key:0,description:"记忆树为空","image-size":40})):U("",!0)]),_:1})]),_:1}),t(h,{span:17},{default:l(()=>[t(C,{shadow:"hover"},{header:l(()=>[u("div",al,[t(ft,{separator:"/"},{default:l(()=>[t(Ne,null,{default:l(()=>[...e[41]||(e[41]=[s("memory",-1)])]),_:1}),(d(!0),b(N,null,Q(fe.value,(a,I)=>(d(),_(Ne,{key:I},{default:l(()=>[s(r(a),1)]),_:2},1024))),128))]),_:1}),E.value?(d(),_(o,{key:0,type:"primary",size:"small",onClick:tt,loading:me.value},{default:l(()=>[...e[42]||(e[42]=[s("保存",-1)])]),_:1},8,["loading"])):U("",!0)])]),default:l(()=>[E.value?(d(),_(x,{key:0,modelValue:B.value,"onUpdate:modelValue":e[13]||(e[13]=a=>B.value=a),type:"textarea",rows:22,style:{"font-family":"monospace"}},null,8,["modelValue"])):(d(),_(Se,{key:1,description:"点击左侧文件查看和编辑","image-size":60}))]),_:1})]),_:1})]),_:1}),t(ge,{modelValue:G.value,"onUpdate:modelValue":e[16]||(e[16]=a=>G.value=a),title:"新建记忆文件",width:"480px"},{footer:l(()=>[t(o,{onClick:e[15]||(e[15]=a=>G.value=!1)},{default:l(()=>[...e[44]||(e[44]=[s("取消",-1)])]),_:1}),t(o,{type:"primary",onClick:lt},{default:l(()=>[...e[45]||(e[45]=[s("创建",-1)])]),_:1})]),default:l(()=>[t(ye,{"label-width":"80px"},{default:l(()=>[t(k,{label:"路径"},{default:l(()=>[t(x,{modelValue:oe.value,"onUpdate:modelValue":e[14]||(e[14]=a=>oe.value=a),placeholder:"例如: projects/my-project.md 或 topics/cooking.md"},null,8,["modelValue"]),t($,{type:"info",size:"small",style:{"margin-top":"4px"}},{default:l(()=>[...e[43]||(e[43]=[s("相对于 memory/ 目录",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ge,{modelValue:H.value,"onUpdate:modelValue":e[19]||(e[19]=a=>H.value=a),title:"添加今日日志",width:"600px"},{footer:l(()=>[t(o,{onClick:e[18]||(e[18]=a=>H.value=!1)},{default:l(()=>[...e[46]||(e[46]=[s("取消",-1)])]),_:1}),t(o,{type:"primary",onClick:at},{default:l(()=>[...e[47]||(e[47]=[s("提交",-1)])]),_:1})]),default:l(()=>[t(x,{modelValue:ie.value,"onUpdate:modelValue":e[17]||(e[17]=a=>ie.value=a),type:"textarea",rows:10,placeholder:"记录今天的重要事项、学习心得、待办..."},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),t(L,{label:"工作区",name:"workspace"},{default:l(()=>[t(j,{gutter:20},{default:l(()=>[t(h,{span:8},{default:l(()=>[t(C,{header:"文件列表"},{default:l(()=>[t(Fe,{data:Ce.value,props:{label:"name",children:"children"},onNodeClick:st,"highlight-current":"","default-expand-all":""},null,8,["data"])]),_:1})]),_:1}),t(h,{span:16},{default:l(()=>[t(C,{header:R.value||"选择文件查看"},{default:l(()=>[R.value?(d(),b(N,{key:0},[t(x,{modelValue:J.value,"onUpdate:modelValue":e[20]||(e[20]=a=>J.value=a),type:"textarea",rows:20},null,8,["modelValue"]),u("div",nl,[t(o,{type:"primary",onClick:ot},{default:l(()=>[...e[48]||(e[48]=[s("保存",-1)])]),_:1}),ue.value?(d(),_($,{key:0,type:"info",size:"small"},{default:l(()=>[s(r(Ie(ue.value.size))+" · "+r(Qe(ue.value.modTime)),1)]),_:1})):U("",!0)])],64)):U("",!0)]),_:1},8,["header"])]),_:1})]),_:1})]),_:1}),t(L,{label:"定时任务",name:"cron"},{default:l(()=>[t(o,{type:"primary",onClick:e[21]||(e[21]=a=>K.value=!0),style:{"margin-bottom":"16px"}},{default:l(()=>[t(P,null,{default:l(()=>[t(z(_e))]),_:1}),e[49]||(e[49]=s(" 新建任务 ",-1))]),_:1}),t(Ue,{data:$e.value,stripe:""},{default:l(()=>[t(V,{prop:"name",label:"名称"}),t(V,{label:"调度"},{default:l(({row:a})=>[s(r(a.schedule?.expr)+" ("+r(a.schedule?.tz)+")",1)]),_:1}),t(V,{label:"最近运行",width:"180"},{default:l(({row:a})=>[a.state?.lastRunAtMs?(d(),b(N,{key:0},[t(y,{type:a.state?.lastStatus==="ok"?"success":"danger",size:"small"},{default:l(()=>[s(r(a.state?.lastStatus),1)]),_:2},1032,["type"]),t($,{type:"info",size:"small",style:{"margin-left":"4px"}},{default:l(()=>[s(r(Xe(a.state?.lastRunAtMs)),1)]),_:2},1024)],64)):(d(),_($,{key:1,type:"info",size:"small"},{default:l(()=>[...e[50]||(e[50]=[s("未运行",-1)])]),_:1}))]),_:1}),t(V,{label:"启用",width:"80"},{default:l(({row:a})=>[t(De,{modelValue:a.enabled,"onUpdate:modelValue":I=>a.enabled=I,onChange:I=>ut(a)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(V,{label:"操作",width:"200"},{default:l(({row:a})=>[t(o,{size:"small",onClick:I=>dt(a)},{default:l(()=>[...e[51]||(e[51]=[s("立即运行",-1)])]),_:1},8,["onClick"]),t(o,{size:"small",type:"danger",onClick:I=>rt(a)},{default:l(()=>[...e[52]||(e[52]=[s("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),t(ge,{modelValue:K.value,"onUpdate:modelValue":e[28]||(e[28]=a=>K.value=a),title:"新建定时任务",width:"520px"},{footer:l(()=>[t(o,{onClick:e[27]||(e[27]=a=>K.value=!1)},{default:l(()=>[...e[53]||(e[53]=[s("取消",-1)])]),_:1}),t(o,{type:"primary",onClick:it},{default:l(()=>[...e[54]||(e[54]=[s("创建",-1)])]),_:1})]),default:l(()=>[t(ye,{model:v.value,"label-width":"100px"},{default:l(()=>[t(k,{label:"名称"},{default:l(()=>[t(x,{modelValue:v.value.name,"onUpdate:modelValue":e[22]||(e[22]=a=>v.value.name=a)},null,8,["modelValue"])]),_:1}),t(k,{label:"Cron 表达式"},{default:l(()=>[t(x,{modelValue:v.value.expr,"onUpdate:modelValue":e[23]||(e[23]=a=>v.value.expr=a),placeholder:"30 3 * * *"},null,8,["modelValue"])]),_:1}),t(k,{label:"时区"},{default:l(()=>[t(S,{modelValue:v.value.tz,"onUpdate:modelValue":e[24]||(e[24]=a=>v.value.tz=a)},{default:l(()=>[t(g,{label:"Asia/Shanghai",value:"Asia/Shanghai"}),t(g,{label:"UTC",value:"UTC"}),t(g,{label:"America/New_York",value:"America/New_York"})]),_:1},8,["modelValue"])]),_:1}),t(k,{label:"消息"},{default:l(()=>[t(x,{modelValue:v.value.message,"onUpdate:modelValue":e[25]||(e[25]=a=>v.value.message=a),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),t(k,{label:"启用"},{default:l(()=>[t(De,{modelValue:v.value.enabled,"onUpdate:modelValue":e[26]||(e[26]=a=>v.value.enabled=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),ml=It(sl,[["__scopeId","data-v-584f5a05"]]);export{ml as default};
