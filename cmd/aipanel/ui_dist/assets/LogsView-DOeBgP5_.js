import{d as B,D as y,i as U,T as z,c as u,b as l,a as o,w as g,h as w,t as x,l as V,P as E,K as O,e as r,z as W,H as C,r as n,o as d,F as D,m as H,s as S,k as G}from"./index-DwNtQzoA.js";import{p as K}from"./index-BpGprwnc.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"logs-page"},j={class:"logs-header"},q={style:{margin:"0"}},J={style:{"font-size":"13px",color:"#909399","margin-top":"4px"}},Q={style:{display:"flex",gap:"10px","align-items":"center"}},X={class:"log-text"},Y={key:0,class:"log-empty"},Z=B({__name:"LogsView",setup($){const p=r([]),a=r(""),_=r(!1),i=r(!0),h=r(null);let f=null;const c=W(()=>{if(!a.value)return p.value;const t=a.value.toLowerCase();return p.value.filter(e=>e.toLowerCase().includes(t))});function L(t){const e=t.toUpperCase();return e.includes("ERROR")||e.includes("[ERR]")||e.includes("FATAL")?"level-error":e.includes("WARN")||e.includes("[WARN]")||e.includes("WARNING")?"level-warn":e.includes("INFO")||e.includes("[INFO]")?"level-info":"level-default"}async function m(){_.value=!0;try{const t=await K.get(500);p.value=t.data.lines??[],i.value&&(await C(),v())}catch{}finally{_.value=!1}}function v(){const t=h.value;t&&(t.scrollTop=t.scrollHeight)}return y(i,t=>{t&&v()}),y(c,async()=>{i.value&&(await C(),v())}),U(()=>{m(),f=setInterval(m,5e3)}),z(()=>{f&&clearInterval(f)}),(t,e)=>{const k=n("List"),N=n("el-icon"),R=n("el-input"),A=n("el-switch"),I=n("el-button"),T=n("el-empty"),b=n("el-card");return d(),u("div",P,[l("div",j,[l("div",null,[l("h2",q,[o(N,{style:{"vertical-align":"-2px","margin-right":"6px"}},{default:g(()=>[o(k)]),_:1}),e[2]||(e[2]=w("系统日志",-1))]),l("div",J," 共 "+x(c.value.length)+" 条 · 每 5 秒自动刷新 ",1)]),l("div",Q,[o(R,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=s=>a.value=s),placeholder:"关键词过滤…",clearable:"",style:{width:"220px"},"prefix-icon":V(E)},null,8,["modelValue","prefix-icon"]),o(A,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=s=>i.value=s),"active-text":"自动滚动"},null,8,["modelValue"]),o(I,{onClick:m,loading:_.value,icon:V(O)},{default:g(()=>[...e[3]||(e[3]=[w("刷新",-1)])]),_:1},8,["loading","icon"])])]),o(b,{shadow:"never",class:"log-card"},{default:g(()=>[l("div",{ref_key:"logContainer",ref:h,class:"log-container"},[(d(!0),u(D,null,H(c.value,(s,F)=>(d(),u("div",{key:F,class:S(["log-line",L(s)])},[l("span",X,x(s),1)],2))),128)),c.value.length===0?(d(),u("div",Y,[o(T,{description:a.value?"无匹配日志":"暂无日志内容"},null,8,["description"])])):G("",!0)],512)]),_:1})])}}}),oe=M(Z,[["__scopeId","data-v-abf510f6"]]);export{oe as default};
